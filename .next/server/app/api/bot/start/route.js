/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/bot/start/route";
exports.ids = ["app/api/bot/start/route"];
exports.modules = {

/***/ "(rsc)/./app/api/bot/start/route.ts":
/*!************************************!*\
  !*** ./app/api/bot/start/route.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/db */ \"(rsc)/./lib/db/index.ts\");\n/* harmony import */ var _lib_db_schema__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/db/schema */ \"(rsc)/./lib/db/schema.ts\");\n/* harmony import */ var _lib_encryption__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../lib/encryption */ \"(rsc)/./lib/encryption.ts\");\n/* harmony import */ var _lib_subscription__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../lib/subscription */ \"(rsc)/./lib/subscription.ts\");\n/* harmony import */ var _lib_bot_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../lib/bot-manager */ \"(rsc)/./lib/bot-manager.ts\");\n/* harmony import */ var _lib_auth_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../lib/auth-utils */ \"(rsc)/./lib/auth-utils.ts\");\n\n\n\n\n\n\n\n\nasync function POST(req) {\n    try {\n        const dbUser = await (0,_lib_auth_utils__WEBPACK_IMPORTED_MODULE_6__.getDbUser)();\n        const subscription = await (0,_lib_subscription__WEBPACK_IMPORTED_MODULE_4__.checkSubscription)(dbUser.id);\n        if (!subscription.isActive) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Active subscription required'\n            }, {\n                status: 403\n            });\n        }\n        const body = await req.json();\n        const { exchangeIds, settings } = body;\n        // Get user's exchange credentials\n        const credentials = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.exchangeCredentials).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.exchangeCredentials.userId, dbUser.id), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.exchangeCredentials.isActive, true)));\n        if (credentials.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'No exchange credentials configured. Please add your API keys first.'\n            }, {\n                status: 400\n            });\n        }\n        // Decrypt credentials for bot use\n        const decryptedCredentials = await Promise.all(credentials.map(async (cred)=>({\n                ...cred,\n                apiSecret: await (0,_lib_encryption__WEBPACK_IMPORTED_MODULE_3__.decryptCredentials)(cred.apiSecret),\n                passphrase: cred.passphrase ? await (0,_lib_encryption__WEBPACK_IMPORTED_MODULE_3__.decryptCredentials)(cred.passphrase) : null,\n                sandbox: cred.sandbox ?? false\n            })));\n        // Start bot instance\n        const botInstance = await (0,_lib_bot_manager__WEBPACK_IMPORTED_MODULE_5__.startBotForUser)(dbUser.id, decryptedCredentials, settings);\n        // Check if bot instance already exists for this user\n        const existingInstance = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.botInstances).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.botInstances.userId, dbUser.id));\n        if (existingInstance.length > 0) {\n            // Update existing instance\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.update(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.botInstances).set({\n                status: 'running',\n                settings: JSON.stringify(settings),\n                startedAt: new Date(),\n                stoppedAt: null,\n                lastHeartbeat: new Date()\n            }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.botInstances.userId, dbUser.id));\n        } else {\n            // Insert new instance\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.insert(_lib_db_schema__WEBPACK_IMPORTED_MODULE_2__.botInstances).values({\n                userId: dbUser.id,\n                status: 'running',\n                settings: JSON.stringify(settings),\n                startedAt: new Date(),\n                lastHeartbeat: new Date()\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: 'Bot started successfully',\n            instanceId: botInstance.id\n        });\n    } catch (error) {\n        console.error('Error starting bot:', error);\n        if (error.message.includes('No Clerk user ID')) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Unauthorized'\n            }, {\n                status: 401\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Failed to start bot. Please try again.',\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RTtRQUM1QjtJQUVGLEVBQUUsT0FBT0csT0FBWTtRQUNuQmtDLFFBQVFsQyxLQUFLLENBQUMsdUJBQXVCQTtRQUVyQyxJQUFJQSxNQUFNZ0MsT0FBTyxDQUFDRyxRQUFRLENBQUMscUJBQXFCO1lBQzlDLE9BQU9wRCxxREFBWUEsQ0FBQ2dCLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUFlLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUNwRTtRQUVBLE9BQU9sQixxREFBWUEsQ0FBQ2dCLElBQUksQ0FBQztZQUN2QkMsT0FBTztZQUNQb0MsU0FBU3BDLE1BQU1nQyxPQUFPO1FBQ3hCLEdBQUc7WUFBRS9CLFFBQVE7UUFBSTtJQUNuQjtBQUNGIiwic291cmNlcyI6WyJDOlxcRGVza3RvcFxcYXV0by10cmFkZS5jb21cXGFwcFxcYXBpXFxib3RcXHN0YXJ0XFxyb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgZXEsIGFuZCB9IGZyb20gJ2RyaXp6bGUtb3JtJztcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vLi4vbGliL2RiJztcbmltcG9ydCB7IGJvdEluc3RhbmNlcywgZXhjaGFuZ2VDcmVkZW50aWFscyB9IGZyb20gJy4uLy4uLy4uLy4uL2xpYi9kYi9zY2hlbWEnO1xuaW1wb3J0IHsgZGVjcnlwdENyZWRlbnRpYWxzIH0gZnJvbSAnLi4vLi4vLi4vLi4vbGliL2VuY3J5cHRpb24nO1xuaW1wb3J0IHsgY2hlY2tTdWJzY3JpcHRpb24gfSBmcm9tICcuLi8uLi8uLi8uLi9saWIvc3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IHN0YXJ0Qm90Rm9yVXNlciB9IGZyb20gJy4uLy4uLy4uLy4uL2xpYi9ib3QtbWFuYWdlcic7XG5pbXBvcnQgeyBnZXREYlVzZXIgfSBmcm9tICcuLi8uLi8uLi8uLi9saWIvYXV0aC11dGlscyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkYlVzZXIgPSBhd2FpdCBnZXREYlVzZXIoKTtcbiAgICBcbiAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBhd2FpdCBjaGVja1N1YnNjcmlwdGlvbihkYlVzZXIuaWQpO1xuICAgIGlmICghc3Vic2NyaXB0aW9uLmlzQWN0aXZlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0FjdGl2ZSBzdWJzY3JpcHRpb24gcmVxdWlyZWQnIH0sIHsgc3RhdHVzOiA0MDMgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc3QgeyBleGNoYW5nZUlkcywgc2V0dGluZ3MgfSA9IGJvZHk7XG5cbiAgICAvLyBHZXQgdXNlcidzIGV4Y2hhbmdlIGNyZWRlbnRpYWxzXG4gICAgY29uc3QgY3JlZGVudGlhbHMgPSBhd2FpdCBkYi5zZWxlY3QoKVxuICAgICAgLmZyb20oZXhjaGFuZ2VDcmVkZW50aWFscylcbiAgICAgIC53aGVyZShhbmQoXG4gICAgICAgIGVxKGV4Y2hhbmdlQ3JlZGVudGlhbHMudXNlcklkLCBkYlVzZXIuaWQpLFxuICAgICAgICBlcShleGNoYW5nZUNyZWRlbnRpYWxzLmlzQWN0aXZlLCB0cnVlKVxuICAgICAgKSk7XG5cbiAgICBpZiAoY3JlZGVudGlhbHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgZXJyb3I6ICdObyBleGNoYW5nZSBjcmVkZW50aWFscyBjb25maWd1cmVkLiBQbGVhc2UgYWRkIHlvdXIgQVBJIGtleXMgZmlyc3QuJyBcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gRGVjcnlwdCBjcmVkZW50aWFscyBmb3IgYm90IHVzZVxuICAgIGNvbnN0IGRlY3J5cHRlZENyZWRlbnRpYWxzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICBjcmVkZW50aWFscy5tYXAoYXN5bmMgKGNyZWQpID0+ICh7XG4gICAgICAgIC4uLmNyZWQsXG4gICAgICAgIGFwaVNlY3JldDogYXdhaXQgZGVjcnlwdENyZWRlbnRpYWxzKGNyZWQuYXBpU2VjcmV0KSxcbiAgICAgICAgcGFzc3BocmFzZTogY3JlZC5wYXNzcGhyYXNlID8gYXdhaXQgZGVjcnlwdENyZWRlbnRpYWxzKGNyZWQucGFzc3BocmFzZSkgOiBudWxsLFxuICAgICAgICBzYW5kYm94OiBjcmVkLnNhbmRib3ggPz8gZmFsc2UsXG4gICAgICB9KSlcbiAgICApO1xuXG4gICAgLy8gU3RhcnQgYm90IGluc3RhbmNlXG4gICAgY29uc3QgYm90SW5zdGFuY2UgPSBhd2FpdCBzdGFydEJvdEZvclVzZXIoZGJVc2VyLmlkLCBkZWNyeXB0ZWRDcmVkZW50aWFscywgc2V0dGluZ3MpO1xuXG4gICAgLy8gQ2hlY2sgaWYgYm90IGluc3RhbmNlIGFscmVhZHkgZXhpc3RzIGZvciB0aGlzIHVzZXJcbiAgICBjb25zdCBleGlzdGluZ0luc3RhbmNlID0gYXdhaXQgZGIuc2VsZWN0KClcbiAgICAgIC5mcm9tKGJvdEluc3RhbmNlcylcbiAgICAgIC53aGVyZShlcShib3RJbnN0YW5jZXMudXNlcklkLCBkYlVzZXIuaWQpKTtcblxuICAgIGlmIChleGlzdGluZ0luc3RhbmNlLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBpbnN0YW5jZVxuICAgICAgYXdhaXQgZGIudXBkYXRlKGJvdEluc3RhbmNlcylcbiAgICAgICAgLnNldCh7XG4gICAgICAgICAgc3RhdHVzOiAncnVubmluZycsXG4gICAgICAgICAgc2V0dGluZ3M6IEpTT04uc3RyaW5naWZ5KHNldHRpbmdzKSxcbiAgICAgICAgICBzdGFydGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgc3RvcHBlZEF0OiBudWxsLFxuICAgICAgICAgIGxhc3RIZWFydGJlYXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVyZShlcShib3RJbnN0YW5jZXMudXNlcklkLCBkYlVzZXIuaWQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSW5zZXJ0IG5ldyBpbnN0YW5jZVxuICAgICAgYXdhaXQgZGIuaW5zZXJ0KGJvdEluc3RhbmNlcykudmFsdWVzKHtcbiAgICAgICAgdXNlcklkOiBkYlVzZXIuaWQsXG4gICAgICAgIHN0YXR1czogJ3J1bm5pbmcnLFxuICAgICAgICBzZXR0aW5nczogSlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpLFxuICAgICAgICBzdGFydGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIGxhc3RIZWFydGJlYXQ6IG5ldyBEYXRlKCksXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxuICAgICAgbWVzc2FnZTogJ0JvdCBzdGFydGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICBpbnN0YW5jZUlkOiBib3RJbnN0YW5jZS5pZCBcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc3RhcnRpbmcgYm90OicsIGVycm9yKTtcbiAgICBcbiAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnTm8gQ2xlcmsgdXNlciBJRCcpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzdGFydCBib3QuIFBsZWFzZSB0cnkgYWdhaW4uJyxcbiAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJlcSIsImFuZCIsImRiIiwiYm90SW5zdGFuY2VzIiwiZXhjaGFuZ2VDcmVkZW50aWFscyIsImRlY3J5cHRDcmVkZW50aWFscyIsImNoZWNrU3Vic2NyaXB0aW9uIiwic3RhcnRCb3RGb3JVc2VyIiwiZ2V0RGJVc2VyIiwiUE9TVCIsInJlcSIsImRiVXNlciIsInN1YnNjcmlwdGlvbiIsImlkIiwiaXNBY3RpdmUiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJib2R5IiwiZXhjaGFuZ2VJZHMiLCJzZXR0aW5ncyIsImNyZWRlbnRpYWxzIiwic2VsZWN0IiwiZnJvbSIsIndoZXJlIiwidXNlcklkIiwibGVuZ3RoIiwiZGVjcnlwdGVkQ3JlZGVudGlhbHMiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwiY3JlZCIsImFwaVNlY3JldCIsInBhc3NwaHJhc2UiLCJzYW5kYm94IiwiYm90SW5zdGFuY2UiLCJleGlzdGluZ0luc3RhbmNlIiwidXBkYXRlIiwic2V0IiwiSlNPTiIsInN0cmluZ2lmeSIsInN0YXJ0ZWRBdCIsIkRhdGUiLCJzdG9wcGVkQXQiLCJsYXN0SGVhcnRiZWF0IiwiaW5zZXJ0IiwidmFsdWVzIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJpbnN0YW5jZUlkIiwiY29uc29sZSIsImluY2x1ZGVzIiwiZGV0YWlscyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/bot/start/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/admin.ts":
/*!**********************!*\
  !*** ./lib/admin.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkAdminAccess: () => (/* binding */ checkAdminAccess),\n/* harmony export */   makeUserAdmin: () => (/* binding */ makeUserAdmin)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db/index.ts\");\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db/schema */ \"(rsc)/./lib/db/schema.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config */ \"(rsc)/./lib/config.ts\");\n\n\n\n\nconst DEFAULT_ADMIN_EMAILS = [\n    'admin@arbitragebot.pro'\n];\nconst ENV_ADMIN_EMAILS = (process.env.ADMIN_EMAILS || '').split(',').map((s)=>s.trim().toLowerCase()).filter((s)=>!!s);\nconst ADMIN_EMAILS = [\n    ...DEFAULT_ADMIN_EMAILS,\n    ...ENV_ADMIN_EMAILS\n];\nasync function checkAdminAccess(userId) {\n    try {\n        (0,_config__WEBPACK_IMPORTED_MODULE_2__.assertProdGuards)();\n        // Global override to grant admin to all users (dev-only)\n        if ((0,_config__WEBPACK_IMPORTED_MODULE_2__.devFlagEnabled)(_config__WEBPACK_IMPORTED_MODULE_2__.FLAGS.GRANT_ADMIN_TO_ALL)) {\n            return true;\n        }\n        const adminUserIds = (process.env.ADMIN_USER_IDS || '').split(',').map((s)=>s.trim()).filter((s)=>!!s);\n        if (adminUserIds.includes(userId)) {\n            return true;\n        }\n        const user = await _db__WEBPACK_IMPORTED_MODULE_0__.db.select().from(_db_schema__WEBPACK_IMPORTED_MODULE_1__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_3__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.users.clerkId, userId)).limit(1);\n        if (user.length === 0) {\n            return false;\n        }\n        const email = (user[0].email || '').toLowerCase();\n        return Boolean(user[0].isAdmin) || ADMIN_EMAILS.includes(email);\n    } catch (error) {\n        console.error('Error checking admin access:', error);\n        return false;\n    }\n}\nasync function makeUserAdmin(userId) {\n    try {\n        await _db__WEBPACK_IMPORTED_MODULE_0__.db.update(_db_schema__WEBPACK_IMPORTED_MODULE_1__.users).set({\n            isAdmin: true\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_3__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.users.clerkId, userId));\n    } catch (error) {\n        console.error('Error making user admin:', error);\n        throw new Error('Failed to update admin status');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWRtaW4udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTBCO0FBQ1U7QUFDSDtBQUNrQztBQUVuRSxNQUFNTSx1QkFBdUI7SUFBQztDQUF5QjtBQUN2RCxNQUFNQyxtQkFBbUIsQ0FBQ0MsUUFBUUMsR0FBRyxDQUFDQyxZQUFZLElBQUksRUFBQyxFQUNwREMsS0FBSyxDQUFDLEtBQ05DLEdBQUcsQ0FBQyxDQUFDQyxJQUFNQSxFQUFFQyxJQUFJLEdBQUdDLFdBQVcsSUFDL0JDLE1BQU0sQ0FBQyxDQUFDSCxJQUFNLENBQUMsQ0FBQ0E7QUFDbkIsTUFBTUgsZUFBZTtPQUFJSjtPQUF5QkM7Q0FBaUI7QUFFNUQsZUFBZVUsaUJBQWlCQyxNQUFjO0lBQ25ELElBQUk7UUFDRmIseURBQWdCQTtRQUNoQix5REFBeUQ7UUFDekQsSUFBSUQsdURBQWNBLENBQUNELDBDQUFLQSxDQUFDZ0Isa0JBQWtCLEdBQUc7WUFDNUMsT0FBTztRQUNUO1FBRUEsTUFBTUMsZUFBZSxDQUFDWixRQUFRQyxHQUFHLENBQUNZLGNBQWMsSUFBSSxFQUFDLEVBQ2xEVixLQUFLLENBQUMsS0FDTkMsR0FBRyxDQUFDLENBQUNDLElBQU1BLEVBQUVDLElBQUksSUFDakJFLE1BQU0sQ0FBQyxDQUFDSCxJQUFNLENBQUMsQ0FBQ0E7UUFFbkIsSUFBSU8sYUFBYUUsUUFBUSxDQUFDSixTQUFTO1lBQ2pDLE9BQU87UUFDVDtRQUVBLE1BQU1LLE9BQU8sTUFBTXZCLG1DQUFFQSxDQUFDd0IsTUFBTSxHQUN6QkMsSUFBSSxDQUFDeEIsNkNBQUtBLEVBQ1Z5QixLQUFLLENBQUN4QiwrQ0FBRUEsQ0FBQ0QsNkNBQUtBLENBQUMwQixPQUFPLEVBQUVULFNBQ3hCVSxLQUFLLENBQUM7UUFFVCxJQUFJTCxLQUFLTSxNQUFNLEtBQUssR0FBRztZQUNyQixPQUFPO1FBQ1Q7UUFFQSxNQUFNQyxRQUFRLENBQUNQLElBQUksQ0FBQyxFQUFFLENBQUNPLEtBQUssSUFBSSxFQUFDLEVBQUdmLFdBQVc7UUFDL0MsT0FBT2dCLFFBQVFSLElBQUksQ0FBQyxFQUFFLENBQUNTLE9BQU8sS0FBS3RCLGFBQWFZLFFBQVEsQ0FBQ1E7SUFDM0QsRUFBRSxPQUFPRyxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxnQ0FBZ0NBO1FBQzlDLE9BQU87SUFDVDtBQUNGO0FBRU8sZUFBZUUsY0FBY2pCLE1BQWM7SUFDaEQsSUFBSTtRQUNGLE1BQU1sQixtQ0FBRUEsQ0FBQ29DLE1BQU0sQ0FBQ25DLDZDQUFLQSxFQUNsQm9DLEdBQUcsQ0FBQztZQUFFTCxTQUFTO1FBQUssR0FDcEJOLEtBQUssQ0FBQ3hCLCtDQUFFQSxDQUFDRCw2Q0FBS0EsQ0FBQzBCLE9BQU8sRUFBRVQ7SUFDN0IsRUFBRSxPQUFPZSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyw0QkFBNEJBO1FBQzFDLE1BQU0sSUFBSUssTUFBTTtJQUNsQjtBQUNGIiwic291cmNlcyI6WyJDOlxcRGVza3RvcFxcYXV0by10cmFkZS5jb21cXGxpYlxcYWRtaW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGIgfSBmcm9tICcuL2RiJztcbmltcG9ydCB7IHVzZXJzIH0gZnJvbSAnLi9kYi9zY2hlbWEnO1xuaW1wb3J0IHsgZXEgfSBmcm9tICdkcml6emxlLW9ybSc7XG5pbXBvcnQgeyBGTEFHUywgZGV2RmxhZ0VuYWJsZWQsIGFzc2VydFByb2RHdWFyZHMgfSBmcm9tICcuL2NvbmZpZyc7XG5cbmNvbnN0IERFRkFVTFRfQURNSU5fRU1BSUxTID0gWydhZG1pbkBhcmJpdHJhZ2Vib3QucHJvJ107XG5jb25zdCBFTlZfQURNSU5fRU1BSUxTID0gKHByb2Nlc3MuZW52LkFETUlOX0VNQUlMUyB8fCAnJylcbiAgLnNwbGl0KCcsJylcbiAgLm1hcCgocykgPT4gcy50cmltKCkudG9Mb3dlckNhc2UoKSlcbiAgLmZpbHRlcigocykgPT4gISFzKTtcbmNvbnN0IEFETUlOX0VNQUlMUyA9IFsuLi5ERUZBVUxUX0FETUlOX0VNQUlMUywgLi4uRU5WX0FETUlOX0VNQUlMU107XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0FkbWluQWNjZXNzKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgYXNzZXJ0UHJvZEd1YXJkcygpO1xuICAgIC8vIEdsb2JhbCBvdmVycmlkZSB0byBncmFudCBhZG1pbiB0byBhbGwgdXNlcnMgKGRldi1vbmx5KVxuICAgIGlmIChkZXZGbGFnRW5hYmxlZChGTEFHUy5HUkFOVF9BRE1JTl9UT19BTEwpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBjb25zdCBhZG1pblVzZXJJZHMgPSAocHJvY2Vzcy5lbnYuQURNSU5fVVNFUl9JRFMgfHwgJycpXG4gICAgICAuc3BsaXQoJywnKVxuICAgICAgLm1hcCgocykgPT4gcy50cmltKCkpXG4gICAgICAuZmlsdGVyKChzKSA9PiAhIXMpO1xuXG4gICAgaWYgKGFkbWluVXNlcklkcy5pbmNsdWRlcyh1c2VySWQpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZGIuc2VsZWN0KClcbiAgICAgIC5mcm9tKHVzZXJzKVxuICAgICAgLndoZXJlKGVxKHVzZXJzLmNsZXJrSWQsIHVzZXJJZCkpXG4gICAgICAubGltaXQoMSk7XG5cbiAgICBpZiAodXNlci5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCBlbWFpbCA9ICh1c2VyWzBdLmVtYWlsIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBCb29sZWFuKHVzZXJbMF0uaXNBZG1pbikgfHwgQURNSU5fRU1BSUxTLmluY2x1ZGVzKGVtYWlsKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyBhZG1pbiBhY2Nlc3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWFrZVVzZXJBZG1pbih1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGF3YWl0IGRiLnVwZGF0ZSh1c2VycylcbiAgICAgIC5zZXQoeyBpc0FkbWluOiB0cnVlIH0pXG4gICAgICAud2hlcmUoZXEodXNlcnMuY2xlcmtJZCwgdXNlcklkKSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFraW5nIHVzZXIgYWRtaW46JywgZXJyb3IpO1xuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHVwZGF0ZSBhZG1pbiBzdGF0dXMnKTtcbiAgfVxufSJdLCJuYW1lcyI6WyJkYiIsInVzZXJzIiwiZXEiLCJGTEFHUyIsImRldkZsYWdFbmFibGVkIiwiYXNzZXJ0UHJvZEd1YXJkcyIsIkRFRkFVTFRfQURNSU5fRU1BSUxTIiwiRU5WX0FETUlOX0VNQUlMUyIsInByb2Nlc3MiLCJlbnYiLCJBRE1JTl9FTUFJTFMiLCJzcGxpdCIsIm1hcCIsInMiLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJmaWx0ZXIiLCJjaGVja0FkbWluQWNjZXNzIiwidXNlcklkIiwiR1JBTlRfQURNSU5fVE9fQUxMIiwiYWRtaW5Vc2VySWRzIiwiQURNSU5fVVNFUl9JRFMiLCJpbmNsdWRlcyIsInVzZXIiLCJzZWxlY3QiLCJmcm9tIiwid2hlcmUiLCJjbGVya0lkIiwibGltaXQiLCJsZW5ndGgiLCJlbWFpbCIsIkJvb2xlYW4iLCJpc0FkbWluIiwiZXJyb3IiLCJjb25zb2xlIiwibWFrZVVzZXJBZG1pbiIsInVwZGF0ZSIsInNldCIsIkVycm9yIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/admin.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth-utils.ts":
/*!***************************!*\
  !*** ./lib/auth-utils.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDbUser: () => (/* binding */ getDbUser)\n/* harmony export */ });\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(rsc)/./node_modules/@clerk/nextjs/dist/esm/app-router/server/auth.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db/index.ts\");\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db/schema */ \"(rsc)/./lib/db/schema.ts\");\n\n\n\n\nasync function getDbUser() {\n    try {\n        const { userId: clerkUserId } = await (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_2__.auth)();\n        if (!clerkUserId) {\n            throw new Error('No Clerk user ID found');\n        }\n        // Check if user exists in database\n        const dbUsers = await _db__WEBPACK_IMPORTED_MODULE_0__.db.select().from(_db_schema__WEBPACK_IMPORTED_MODULE_1__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_3__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.users.clerkId, clerkUserId));\n        if (dbUsers.length > 0) {\n            return dbUsers[0];\n        }\n        // If user doesn't exist, create them\n        if (!process.env.CLERK_SECRET_KEY) {\n            throw new Error('CLERK_SECRET_KEY is missing');\n        }\n        // Get user info from Clerk\n        const response = await fetch(`https://api.clerk.com/v1/users/${clerkUserId}`, {\n            headers: {\n                'Authorization': `Bearer ${process.env.CLERK_SECRET_KEY}`,\n                'Content-Type': 'application/json'\n            }\n        });\n        if (!response.ok) {\n            throw new Error(`Failed to fetch user from Clerk: ${response.status}`);\n        }\n        const clerkUser = await response.json();\n        // Create user in database\n        const [newUser] = await _db__WEBPACK_IMPORTED_MODULE_0__.db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_1__.users).values({\n            id: `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            clerkId: clerkUserId,\n            email: clerkUser.email_addresses?.[0]?.email_address || 'no-email@example.com',\n            firstName: clerkUser.first_name || '',\n            lastName: clerkUser.last_name || '',\n            imageUrl: clerkUser.image_url || ''\n        }).returning();\n        console.log('Created new user in database:', newUser.id);\n        return newUser;\n    } catch (error) {\n        console.error('Error in getDbUser:', error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC11dGlscy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUE0QztBQUNYO0FBQ1A7QUFDVTtBQUU3QixlQUFlSTtJQUNwQixJQUFJO1FBQ0YsTUFBTSxFQUFFQyxRQUFRQyxXQUFXLEVBQUUsR0FBRyxNQUFNTiwwREFBSUE7UUFFMUMsSUFBSSxDQUFDTSxhQUFhO1lBQ2hCLE1BQU0sSUFBSUMsTUFBTTtRQUNsQjtRQUVBLG1DQUFtQztRQUNuQyxNQUFNQyxVQUFVLE1BQU1OLG1DQUFFQSxDQUFDTyxNQUFNLEdBQUdDLElBQUksQ0FBQ1AsNkNBQUtBLEVBQUVRLEtBQUssQ0FBQ1YsK0NBQUVBLENBQUNFLDZDQUFLQSxDQUFDUyxPQUFPLEVBQUVOO1FBRXRFLElBQUlFLFFBQVFLLE1BQU0sR0FBRyxHQUFHO1lBQ3RCLE9BQU9MLE9BQU8sQ0FBQyxFQUFFO1FBQ25CO1FBRUEscUNBQXFDO1FBQ3JDLElBQUksQ0FBQ00sUUFBUUMsR0FBRyxDQUFDQyxnQkFBZ0IsRUFBRTtZQUNqQyxNQUFNLElBQUlULE1BQU07UUFDbEI7UUFFQSwyQkFBMkI7UUFDM0IsTUFBTVUsV0FBVyxNQUFNQyxNQUFNLENBQUMsK0JBQStCLEVBQUVaLGFBQWEsRUFBRTtZQUM1RWEsU0FBUztnQkFDUCxpQkFBaUIsQ0FBQyxPQUFPLEVBQUVMLFFBQVFDLEdBQUcsQ0FBQ0MsZ0JBQWdCLEVBQUU7Z0JBQ3pELGdCQUFnQjtZQUNsQjtRQUNGO1FBRUEsSUFBSSxDQUFDQyxTQUFTRyxFQUFFLEVBQUU7WUFDaEIsTUFBTSxJQUFJYixNQUFNLENBQUMsaUNBQWlDLEVBQUVVLFNBQVNJLE1BQU0sRUFBRTtRQUN2RTtRQUVBLE1BQU1DLFlBQVksTUFBTUwsU0FBU00sSUFBSTtRQUVyQywwQkFBMEI7UUFDMUIsTUFBTSxDQUFDQyxRQUFRLEdBQUcsTUFBTXRCLG1DQUFFQSxDQUFDdUIsTUFBTSxDQUFDdEIsNkNBQUtBLEVBQUV1QixNQUFNLENBQUM7WUFDOUNDLElBQUksQ0FBQyxLQUFLLEVBQUVDLEtBQUtDLEdBQUcsR0FBRyxDQUFDLEVBQUVDLEtBQUtDLE1BQU0sR0FBR0MsUUFBUSxDQUFDLElBQUlDLE1BQU0sQ0FBQyxHQUFHLElBQUk7WUFDbkVyQixTQUFTTjtZQUNUNEIsT0FBT1osVUFBVWEsZUFBZSxFQUFFLENBQUMsRUFBRSxFQUFFQyxpQkFBaUI7WUFDeERDLFdBQVdmLFVBQVVnQixVQUFVLElBQUk7WUFDbkNDLFVBQVVqQixVQUFVa0IsU0FBUyxJQUFJO1lBQ2pDQyxVQUFVbkIsVUFBVW9CLFNBQVMsSUFBSTtRQUNuQyxHQUFHQyxTQUFTO1FBRVpDLFFBQVFDLEdBQUcsQ0FBQyxpQ0FBaUNyQixRQUFRRyxFQUFFO1FBQ3ZELE9BQU9IO0lBRVQsRUFBRSxPQUFPc0IsT0FBTztRQUNkRixRQUFRRSxLQUFLLENBQUMsdUJBQXVCQTtRQUNyQyxNQUFNQTtJQUNSO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxEZXNrdG9wXFxhdXRvLXRyYWRlLmNvbVxcbGliXFxhdXRoLXV0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGF1dGggfSBmcm9tICdAY2xlcmsvbmV4dGpzL3NlcnZlcic7XHJcbmltcG9ydCB7IGVxIH0gZnJvbSAnZHJpenpsZS1vcm0nO1xyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4vZGInO1xyXG5pbXBvcnQgeyB1c2VycyB9IGZyb20gJy4vZGIvc2NoZW1hJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXREYlVzZXIoKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgdXNlcklkOiBjbGVya1VzZXJJZCB9ID0gYXdhaXQgYXV0aCgpO1xyXG4gICAgXHJcbiAgICBpZiAoIWNsZXJrVXNlcklkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gQ2xlcmsgdXNlciBJRCBmb3VuZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGlmIHVzZXIgZXhpc3RzIGluIGRhdGFiYXNlXHJcbiAgICBjb25zdCBkYlVzZXJzID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbSh1c2Vycykud2hlcmUoZXEodXNlcnMuY2xlcmtJZCwgY2xlcmtVc2VySWQpKTtcclxuICAgIFxyXG4gICAgaWYgKGRiVXNlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4gZGJVc2Vyc1swXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiB1c2VyIGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZSB0aGVtXHJcbiAgICBpZiAoIXByb2Nlc3MuZW52LkNMRVJLX1NFQ1JFVF9LRVkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDTEVSS19TRUNSRVRfS0VZIGlzIG1pc3NpbmcnKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgdXNlciBpbmZvIGZyb20gQ2xlcmtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLmNsZXJrLmNvbS92MS91c2Vycy8ke2NsZXJrVXNlcklkfWAsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Byb2Nlc3MuZW52LkNMRVJLX1NFQ1JFVF9LRVl9YCxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggdXNlciBmcm9tIENsZXJrOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVya1VzZXIgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHVzZXIgaW4gZGF0YWJhc2VcclxuICAgIGNvbnN0IFtuZXdVc2VyXSA9IGF3YWl0IGRiLmluc2VydCh1c2VycykudmFsdWVzKHtcclxuICAgICAgaWQ6IGB1c2VyXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YCxcclxuICAgICAgY2xlcmtJZDogY2xlcmtVc2VySWQsXHJcbiAgICAgIGVtYWlsOiBjbGVya1VzZXIuZW1haWxfYWRkcmVzc2VzPy5bMF0/LmVtYWlsX2FkZHJlc3MgfHwgJ25vLWVtYWlsQGV4YW1wbGUuY29tJyxcclxuICAgICAgZmlyc3ROYW1lOiBjbGVya1VzZXIuZmlyc3RfbmFtZSB8fCAnJyxcclxuICAgICAgbGFzdE5hbWU6IGNsZXJrVXNlci5sYXN0X25hbWUgfHwgJycsXHJcbiAgICAgIGltYWdlVXJsOiBjbGVya1VzZXIuaW1hZ2VfdXJsIHx8ICcnLFxyXG4gICAgfSkucmV0dXJuaW5nKCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0NyZWF0ZWQgbmV3IHVzZXIgaW4gZGF0YWJhc2U6JywgbmV3VXNlci5pZCk7XHJcbiAgICByZXR1cm4gbmV3VXNlcjtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldERiVXNlcjonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiYXV0aCIsImVxIiwiZGIiLCJ1c2VycyIsImdldERiVXNlciIsInVzZXJJZCIsImNsZXJrVXNlcklkIiwiRXJyb3IiLCJkYlVzZXJzIiwic2VsZWN0IiwiZnJvbSIsIndoZXJlIiwiY2xlcmtJZCIsImxlbmd0aCIsInByb2Nlc3MiLCJlbnYiLCJDTEVSS19TRUNSRVRfS0VZIiwicmVzcG9uc2UiLCJmZXRjaCIsImhlYWRlcnMiLCJvayIsInN0YXR1cyIsImNsZXJrVXNlciIsImpzb24iLCJuZXdVc2VyIiwiaW5zZXJ0IiwidmFsdWVzIiwiaWQiLCJEYXRlIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwiZW1haWwiLCJlbWFpbF9hZGRyZXNzZXMiLCJlbWFpbF9hZGRyZXNzIiwiZmlyc3ROYW1lIiwiZmlyc3RfbmFtZSIsImxhc3ROYW1lIiwibGFzdF9uYW1lIiwiaW1hZ2VVcmwiLCJpbWFnZV91cmwiLCJyZXR1cm5pbmciLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth-utils.ts\n");

/***/ }),

/***/ "(rsc)/./lib/bot-manager.ts":
/*!****************************!*\
  !*** ./lib/bot-manager.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   emergencyStopAllBots: () => (/* binding */ emergencyStopAllBots),\n/* harmony export */   getAllActiveBots: () => (/* binding */ getAllActiveBots),\n/* harmony export */   getBotStatus: () => (/* binding */ getBotStatus),\n/* harmony export */   startBotForUser: () => (/* binding */ startBotForUser),\n/* harmony export */   stopBotForUser: () => (/* binding */ stopBotForUser)\n/* harmony export */ });\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db/index.ts\");\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./db/schema */ \"(rsc)/./lib/db/schema.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n\n\n\n\n\n// In-memory store for active bot instances\nconst activeBots = new Map();\nasync function startBotForUser(userId, credentials, settings) {\n    try {\n        // Stop existing bot if running\n        await stopBotForUser(userId);\n        // Create environment variables for the bot\n        const env = {\n            ...process.env,\n            USER_ID: userId,\n            BOT_SETTINGS: JSON.stringify(settings),\n            BOT_CREDENTIALS: JSON.stringify(credentials),\n            MIN_PROFIT_PERCENTAGE: settings.minProfitPercentage.toString(),\n            MAX_TRADE_AMOUNT: settings.maxTradeAmount.toString(),\n            AUTO_TRADING_MODE: settings.autoTradingMode.toString(),\n            SELECTED_EXCHANGES: settings.selectedExchanges.join(','),\n            NODE_ENV: \"development\" || 0\n        };\n        // Add exchange-specific credentials to environment\n        credentials.forEach((cred)=>{\n            const prefix = cred.exchangeId.toUpperCase();\n            env[`${prefix}_API_KEY`] = cred.apiKey;\n            env[`${prefix}_API_SECRET`] = cred.apiSecret;\n            if (cred.passphrase) {\n                env[`${prefix}_PASSPHRASE`] = cred.passphrase;\n            }\n            env[`${prefix}_SANDBOX`] = cred.sandbox.toString();\n        });\n        // Start Python bot process\n        const botPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'python-bot', 'main_saas.py');\n        const botProcess = (0,child_process__WEBPACK_IMPORTED_MODULE_0__.spawn)('python', [\n            botPath\n        ], {\n            env,\n            stdio: [\n                'pipe',\n                'pipe',\n                'pipe'\n            ],\n            cwd: path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'python-bot')\n        });\n        const botInstance = {\n            id: `bot_${userId}_${Date.now()}`,\n            userId,\n            process: botProcess,\n            status: 'running',\n            startedAt: new Date()\n        };\n        // Store in memory\n        activeBots.set(userId, botInstance);\n        // Set up process event handlers\n        botProcess.stdout?.on('data', (data)=>{\n            console.log(`Bot ${userId} stdout:`, data.toString());\n            handleBotOutput(userId, data.toString());\n        });\n        botProcess.stderr?.on('data', (data)=>{\n            console.error(`Bot ${userId} stderr:`, data.toString());\n            handleBotError(userId, data.toString());\n        });\n        botProcess.on('exit', (code)=>{\n            console.log(`Bot ${userId} exited with code:`, code);\n            handleBotExit(userId, code);\n        });\n        botProcess.on('error', (error)=>{\n            console.error(`Bot ${userId} error:`, error);\n            handleBotProcessError(userId, error);\n        });\n        console.log(`Started bot for user ${userId} with PID ${botProcess.pid}`);\n        return botInstance;\n    } catch (error) {\n        console.error('Error starting bot for user:', userId, error);\n        throw new Error('Failed to start bot instance');\n    }\n}\nasync function stopBotForUser(userId) {\n    try {\n        const botInstance = activeBots.get(userId);\n        if (botInstance && botInstance.process) {\n            // Gracefully terminate the process\n            botInstance.process.kill('SIGTERM');\n            // Force kill after 10 seconds if still running\n            setTimeout(()=>{\n                if (botInstance.process && !botInstance.process.killed) {\n                    botInstance.process.kill('SIGKILL');\n                }\n            }, 10000);\n            // Remove from active bots\n            activeBots.delete(userId);\n            console.log(`Stopped bot for user ${userId}`);\n        }\n    } catch (error) {\n        console.error('Error stopping bot for user:', userId, error);\n        throw new Error('Failed to stop bot instance');\n    }\n}\nasync function getBotStatus(userId) {\n    return activeBots.get(userId) || null;\n}\nasync function getAllActiveBots() {\n    return Array.from(activeBots.values());\n}\nasync function emergencyStopAllBots() {\n    console.log('EMERGENCY STOP: Stopping all bot instances');\n    const promises = Array.from(activeBots.keys()).map((userId)=>stopBotForUser(userId).catch((error)=>console.error(`Failed to stop bot for user ${userId}:`, error)));\n    await Promise.all(promises);\n    console.log('EMERGENCY STOP: All bots stopped');\n}\n// Event handlers\nasync function handleBotOutput(userId, output) {\n    try {\n        // Parse bot output for trade information\n        if (output.includes('TRADE_COMPLETED')) {\n            const tradeData = parseTradeOutput(output);\n            if (tradeData) {\n                await saveTrade(userId, tradeData);\n            }\n        }\n        // Update heartbeat\n        await updateBotHeartbeat(userId);\n    } catch (error) {\n        console.error('Error handling bot output:', error);\n    }\n}\nasync function handleBotError(userId, error) {\n    try {\n        console.error(`Bot error for user ${userId}:`, error);\n        // Update bot status to error\n        await _db__WEBPACK_IMPORTED_MODULE_2__.db.update(_db_schema__WEBPACK_IMPORTED_MODULE_3__.botInstances).set({\n            status: 'error',\n            stoppedAt: new Date()\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_4__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_3__.botInstances.userId, userId));\n    } catch (dbError) {\n        console.error('Error updating bot status:', dbError);\n    }\n}\nasync function handleBotExit(userId, code) {\n    try {\n        activeBots.delete(userId);\n        await _db__WEBPACK_IMPORTED_MODULE_2__.db.update(_db_schema__WEBPACK_IMPORTED_MODULE_3__.botInstances).set({\n            status: 'stopped',\n            stoppedAt: new Date()\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_4__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_3__.botInstances.userId, userId));\n        console.log(`Bot for user ${userId} exited with code ${code}`);\n    } catch (error) {\n        console.error('Error handling bot exit:', error);\n    }\n}\nasync function handleBotProcessError(userId, error) {\n    try {\n        activeBots.delete(userId);\n        await _db__WEBPACK_IMPORTED_MODULE_2__.db.update(_db_schema__WEBPACK_IMPORTED_MODULE_3__.botInstances).set({\n            status: 'error',\n            stoppedAt: new Date()\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_4__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_3__.botInstances.userId, userId));\n        console.error(`Bot process error for user ${userId}:`, error);\n    } catch (dbError) {\n        console.error('Error handling bot process error:', dbError);\n    }\n}\nasync function updateBotHeartbeat(userId) {\n    try {\n        await _db__WEBPACK_IMPORTED_MODULE_2__.db.update(_db_schema__WEBPACK_IMPORTED_MODULE_3__.botInstances).set({\n            lastHeartbeat: new Date()\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_4__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_3__.botInstances.userId, userId));\n    } catch (error) {\n        console.error('Error updating bot heartbeat:', error);\n    }\n}\nfunction parseTradeOutput(output) {\n    try {\n        // Parse the trade output from the Python bot\n        // This would need to match the output format from your bot\n        const tradeMatch = output.match(/TRADE_COMPLETED: (.+)/);\n        if (tradeMatch) {\n            return JSON.parse(tradeMatch[1]);\n        }\n        return null;\n    } catch (error) {\n        console.error('Error parsing trade output:', error);\n        return null;\n    }\n}\nasync function saveTrade(userId, tradeData) {\n    try {\n        await _db__WEBPACK_IMPORTED_MODULE_2__.db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_3__.trades).values({\n            userId,\n            exchangeId: tradeData.exchange,\n            trianglePath: tradeData.trianglePath,\n            initialAmount: tradeData.initialAmount.toString(),\n            finalAmount: tradeData.finalAmount.toString(),\n            profitAmount: tradeData.profitAmount.toString(),\n            profitPercentage: tradeData.profitPercentage.toString(),\n            fees: tradeData.fees.toString(),\n            status: tradeData.status,\n            executionTimeMs: tradeData.executionTimeMs,\n            errorMessage: tradeData.errorMessage,\n            tradeData: tradeData\n        });\n        console.log(`Saved trade for user ${userId}:`, tradeData);\n    } catch (error) {\n        console.error('Error saving trade:', error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WyJDOlxcRGVza3RvcFxcYXV0by10cmFkZS5jb21cXGxpYlxcYm90LW1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Bhd24sIENoaWxkUHJvY2VzcyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBkYiB9IGZyb20gJy4vZGInO1xuaW1wb3J0IHsgYm90SW5zdGFuY2VzLCB0cmFkZXMgfSBmcm9tICcuL2RiL3NjaGVtYSc7XG5pbXBvcnQgeyBlcSB9IGZyb20gJ2RyaXp6bGUtb3JtJztcblxuaW50ZXJmYWNlIEJvdEluc3RhbmNlIHtcbiAgaWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHByb2Nlc3M6IENoaWxkUHJvY2VzcztcbiAgc3RhdHVzOiAncnVubmluZycgfCAnc3RvcHBlZCcgfCAnZXJyb3InO1xuICBzdGFydGVkQXQ6IERhdGU7XG59XG5cbmludGVyZmFjZSBFeGNoYW5nZUNyZWRlbnRpYWwge1xuICBleGNoYW5nZUlkOiBzdHJpbmc7XG4gIGFwaUtleTogc3RyaW5nO1xuICBhcGlTZWNyZXQ6IHN0cmluZztcbiAgcGFzc3BocmFzZT86IHN0cmluZyB8IG51bGw7XG4gIHNhbmRib3g6IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBCb3RTZXR0aW5ncyB7XG4gIG1pblByb2ZpdFBlcmNlbnRhZ2U6IG51bWJlcjtcbiAgbWF4VHJhZGVBbW91bnQ6IG51bWJlcjtcbiAgYXV0b1RyYWRpbmdNb2RlOiBib29sZWFuO1xuICBzZWxlY3RlZEV4Y2hhbmdlczogc3RyaW5nW107XG4gIHJpc2tNYW5hZ2VtZW50OiB7XG4gICAgbWF4RGFpbHlMb3NzOiBudW1iZXI7XG4gICAgbWF4Q29uY3VycmVudFRyYWRlczogbnVtYmVyO1xuICAgIHN0b3BMb3NzUGVyY2VudGFnZTogbnVtYmVyO1xuICB9O1xufVxuXG4vLyBJbi1tZW1vcnkgc3RvcmUgZm9yIGFjdGl2ZSBib3QgaW5zdGFuY2VzXG5jb25zdCBhY3RpdmVCb3RzID0gbmV3IE1hcDxzdHJpbmcsIEJvdEluc3RhbmNlPigpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhcnRCb3RGb3JVc2VyKFxuICB1c2VySWQ6IHN0cmluZywgXG4gIGNyZWRlbnRpYWxzOiBFeGNoYW5nZUNyZWRlbnRpYWxbXSwgXG4gIHNldHRpbmdzOiBCb3RTZXR0aW5nc1xuKTogUHJvbWlzZTxCb3RJbnN0YW5jZT4ge1xuICB0cnkge1xuICAgIC8vIFN0b3AgZXhpc3RpbmcgYm90IGlmIHJ1bm5pbmdcbiAgICBhd2FpdCBzdG9wQm90Rm9yVXNlcih1c2VySWQpO1xuXG4gICAgLy8gQ3JlYXRlIGVudmlyb25tZW50IHZhcmlhYmxlcyBmb3IgdGhlIGJvdFxuICAgIGNvbnN0IGVudjogTm9kZUpTLlByb2Nlc3NFbnYgPSB7XG4gICAgICAuLi5wcm9jZXNzLmVudixcbiAgICAgIFVTRVJfSUQ6IHVzZXJJZCxcbiAgICAgIEJPVF9TRVRUSU5HUzogSlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpLFxuICAgICAgQk9UX0NSRURFTlRJQUxTOiBKU09OLnN0cmluZ2lmeShjcmVkZW50aWFscyksXG4gICAgICBNSU5fUFJPRklUX1BFUkNFTlRBR0U6IHNldHRpbmdzLm1pblByb2ZpdFBlcmNlbnRhZ2UudG9TdHJpbmcoKSxcbiAgICAgIE1BWF9UUkFERV9BTU9VTlQ6IHNldHRpbmdzLm1heFRyYWRlQW1vdW50LnRvU3RyaW5nKCksXG4gICAgICBBVVRPX1RSQURJTkdfTU9ERTogc2V0dGluZ3MuYXV0b1RyYWRpbmdNb2RlLnRvU3RyaW5nKCksXG4gICAgICBTRUxFQ1RFRF9FWENIQU5HRVM6IHNldHRpbmdzLnNlbGVjdGVkRXhjaGFuZ2VzLmpvaW4oJywnKSxcbiAgICAgIE5PREVfRU5WOiBwcm9jZXNzLmVudi5OT0RFX0VOViB8fCAnZGV2ZWxvcG1lbnQnLCAvLyBFbnN1cmUgTk9ERV9FTlYgaXMgcHJlc2VudFxuICAgIH07XG5cbiAgICAvLyBBZGQgZXhjaGFuZ2Utc3BlY2lmaWMgY3JlZGVudGlhbHMgdG8gZW52aXJvbm1lbnRcbiAgICBjcmVkZW50aWFscy5mb3JFYWNoKChjcmVkKSA9PiB7XG4gICAgICBjb25zdCBwcmVmaXggPSBjcmVkLmV4Y2hhbmdlSWQudG9VcHBlckNhc2UoKTtcbiAgICAgIGVudltgJHtwcmVmaXh9X0FQSV9LRVlgXSA9IGNyZWQuYXBpS2V5O1xuICAgICAgZW52W2Ake3ByZWZpeH1fQVBJX1NFQ1JFVGBdID0gY3JlZC5hcGlTZWNyZXQ7XG4gICAgICBpZiAoY3JlZC5wYXNzcGhyYXNlKSB7XG4gICAgICAgIGVudltgJHtwcmVmaXh9X1BBU1NQSFJBU0VgXSA9IGNyZWQucGFzc3BocmFzZTtcbiAgICAgIH1cbiAgICAgIGVudltgJHtwcmVmaXh9X1NBTkRCT1hgXSA9IGNyZWQuc2FuZGJveC50b1N0cmluZygpO1xuICAgIH0pO1xuXG4gICAgLy8gU3RhcnQgUHl0aG9uIGJvdCBwcm9jZXNzXG4gICAgY29uc3QgYm90UGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHl0aG9uLWJvdCcsICdtYWluX3NhYXMucHknKTtcbiAgICBjb25zdCBib3RQcm9jZXNzOiBDaGlsZFByb2Nlc3MgPSBzcGF3bigncHl0aG9uJywgW2JvdFBhdGhdLCB7XG4gICAgICBlbnYsXG4gICAgICBzdGRpbzogWydwaXBlJywgJ3BpcGUnLCAncGlwZSddLFxuICAgICAgY3dkOiBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B5dGhvbi1ib3QnKSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGJvdEluc3RhbmNlOiBCb3RJbnN0YW5jZSA9IHtcbiAgICAgIGlkOiBgYm90XyR7dXNlcklkfV8ke0RhdGUubm93KCl9YCxcbiAgICAgIHVzZXJJZCxcbiAgICAgIHByb2Nlc3M6IGJvdFByb2Nlc3MsXG4gICAgICBzdGF0dXM6ICdydW5uaW5nJyxcbiAgICAgIHN0YXJ0ZWRBdDogbmV3IERhdGUoKSxcbiAgICB9O1xuXG4gICAgLy8gU3RvcmUgaW4gbWVtb3J5XG4gICAgYWN0aXZlQm90cy5zZXQodXNlcklkLCBib3RJbnN0YW5jZSk7XG5cbiAgICAvLyBTZXQgdXAgcHJvY2VzcyBldmVudCBoYW5kbGVyc1xuICAgIGJvdFByb2Nlc3Muc3Rkb3V0Py5vbignZGF0YScsIChkYXRhOiBCdWZmZXIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBCb3QgJHt1c2VySWR9IHN0ZG91dDpgLCBkYXRhLnRvU3RyaW5nKCkpO1xuICAgICAgaGFuZGxlQm90T3V0cHV0KHVzZXJJZCwgZGF0YS50b1N0cmluZygpKTtcbiAgICB9KTtcblxuICAgIGJvdFByb2Nlc3Muc3RkZXJyPy5vbignZGF0YScsIChkYXRhOiBCdWZmZXIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEJvdCAke3VzZXJJZH0gc3RkZXJyOmAsIGRhdGEudG9TdHJpbmcoKSk7XG4gICAgICBoYW5kbGVCb3RFcnJvcih1c2VySWQsIGRhdGEudG9TdHJpbmcoKSk7XG4gICAgfSk7XG5cbiAgICBib3RQcm9jZXNzLm9uKCdleGl0JywgKGNvZGU6IG51bWJlciB8IG51bGwpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBCb3QgJHt1c2VySWR9IGV4aXRlZCB3aXRoIGNvZGU6YCwgY29kZSk7XG4gICAgICBoYW5kbGVCb3RFeGl0KHVzZXJJZCwgY29kZSk7XG4gICAgfSk7XG5cbiAgICBib3RQcm9jZXNzLm9uKCdlcnJvcicsIChlcnJvcjogRXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEJvdCAke3VzZXJJZH0gZXJyb3I6YCwgZXJyb3IpO1xuICAgICAgaGFuZGxlQm90UHJvY2Vzc0Vycm9yKHVzZXJJZCwgZXJyb3IpO1xuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coYFN0YXJ0ZWQgYm90IGZvciB1c2VyICR7dXNlcklkfSB3aXRoIFBJRCAke2JvdFByb2Nlc3MucGlkfWApO1xuICAgIHJldHVybiBib3RJbnN0YW5jZTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN0YXJ0aW5nIGJvdCBmb3IgdXNlcjonLCB1c2VySWQsIGVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBzdGFydCBib3QgaW5zdGFuY2UnKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RvcEJvdEZvclVzZXIodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib3RJbnN0YW5jZSA9IGFjdGl2ZUJvdHMuZ2V0KHVzZXJJZCk7XG4gICAgXG4gICAgaWYgKGJvdEluc3RhbmNlICYmIGJvdEluc3RhbmNlLnByb2Nlc3MpIHtcbiAgICAgIC8vIEdyYWNlZnVsbHkgdGVybWluYXRlIHRoZSBwcm9jZXNzXG4gICAgICBib3RJbnN0YW5jZS5wcm9jZXNzLmtpbGwoJ1NJR1RFUk0nKTtcbiAgICAgIFxuICAgICAgLy8gRm9yY2Uga2lsbCBhZnRlciAxMCBzZWNvbmRzIGlmIHN0aWxsIHJ1bm5pbmdcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAoYm90SW5zdGFuY2UucHJvY2VzcyAmJiAhYm90SW5zdGFuY2UucHJvY2Vzcy5raWxsZWQpIHtcbiAgICAgICAgICBib3RJbnN0YW5jZS5wcm9jZXNzLmtpbGwoJ1NJR0tJTEwnKTtcbiAgICAgICAgfVxuICAgICAgfSwgMTAwMDApO1xuXG4gICAgICAvLyBSZW1vdmUgZnJvbSBhY3RpdmUgYm90c1xuICAgICAgYWN0aXZlQm90cy5kZWxldGUodXNlcklkKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFN0b3BwZWQgYm90IGZvciB1c2VyICR7dXNlcklkfWApO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzdG9wcGluZyBib3QgZm9yIHVzZXI6JywgdXNlcklkLCBlcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gc3RvcCBib3QgaW5zdGFuY2UnKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Qm90U3RhdHVzKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxCb3RJbnN0YW5jZSB8IG51bGw+IHtcbiAgcmV0dXJuIGFjdGl2ZUJvdHMuZ2V0KHVzZXJJZCkgfHwgbnVsbDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbEFjdGl2ZUJvdHMoKTogUHJvbWlzZTxCb3RJbnN0YW5jZVtdPiB7XG4gIHJldHVybiBBcnJheS5mcm9tKGFjdGl2ZUJvdHMudmFsdWVzKCkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW1lcmdlbmN5U3RvcEFsbEJvdHMoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnNvbGUubG9nKCdFTUVSR0VOQ1kgU1RPUDogU3RvcHBpbmcgYWxsIGJvdCBpbnN0YW5jZXMnKTtcbiAgXG4gIGNvbnN0IHByb21pc2VzID0gQXJyYXkuZnJvbShhY3RpdmVCb3RzLmtleXMoKSkubWFwKHVzZXJJZCA9PiBcbiAgICBzdG9wQm90Rm9yVXNlcih1c2VySWQpLmNhdGNoKGVycm9yID0+IFxuICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHN0b3AgYm90IGZvciB1c2VyICR7dXNlcklkfTpgLCBlcnJvcilcbiAgICApXG4gICk7XG4gIFxuICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gIGNvbnNvbGUubG9nKCdFTUVSR0VOQ1kgU1RPUDogQWxsIGJvdHMgc3RvcHBlZCcpO1xufVxuXG4vLyBFdmVudCBoYW5kbGVyc1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlQm90T3V0cHV0KHVzZXJJZDogc3RyaW5nLCBvdXRwdXQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIC8vIFBhcnNlIGJvdCBvdXRwdXQgZm9yIHRyYWRlIGluZm9ybWF0aW9uXG4gICAgaWYgKG91dHB1dC5pbmNsdWRlcygnVFJBREVfQ09NUExFVEVEJykpIHtcbiAgICAgIGNvbnN0IHRyYWRlRGF0YSA9IHBhcnNlVHJhZGVPdXRwdXQob3V0cHV0KTtcbiAgICAgIGlmICh0cmFkZURhdGEpIHtcbiAgICAgICAgYXdhaXQgc2F2ZVRyYWRlKHVzZXJJZCwgdHJhZGVEYXRhKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gVXBkYXRlIGhlYXJ0YmVhdFxuICAgIGF3YWl0IHVwZGF0ZUJvdEhlYXJ0YmVhdCh1c2VySWQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGhhbmRsaW5nIGJvdCBvdXRwdXQ6JywgZXJyb3IpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUJvdEVycm9yKHVzZXJJZDogc3RyaW5nLCBlcnJvcjogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5lcnJvcihgQm90IGVycm9yIGZvciB1c2VyICR7dXNlcklkfTpgLCBlcnJvcik7XG4gICAgXG4gICAgLy8gVXBkYXRlIGJvdCBzdGF0dXMgdG8gZXJyb3JcbiAgICBhd2FpdCBkYi51cGRhdGUoYm90SW5zdGFuY2VzKVxuICAgICAgLnNldCh7XG4gICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgc3RvcHBlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgfSlcbiAgICAgIC53aGVyZShlcShib3RJbnN0YW5jZXMudXNlcklkLCB1c2VySWQpKTtcbiAgICAgIFxuICB9IGNhdGNoIChkYkVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgYm90IHN0YXR1czonLCBkYkVycm9yKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVCb3RFeGl0KHVzZXJJZDogc3RyaW5nLCBjb2RlOiBudW1iZXIgfCBudWxsKSB7XG4gIHRyeSB7XG4gICAgYWN0aXZlQm90cy5kZWxldGUodXNlcklkKTtcbiAgICBcbiAgICBhd2FpdCBkYi51cGRhdGUoYm90SW5zdGFuY2VzKVxuICAgICAgLnNldCh7XG4gICAgICAgIHN0YXR1czogJ3N0b3BwZWQnLFxuICAgICAgICBzdG9wcGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB9KVxuICAgICAgLndoZXJlKGVxKGJvdEluc3RhbmNlcy51c2VySWQsIHVzZXJJZCkpO1xuICAgICAgXG4gICAgY29uc29sZS5sb2coYEJvdCBmb3IgdXNlciAke3VzZXJJZH0gZXhpdGVkIHdpdGggY29kZSAke2NvZGV9YCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaGFuZGxpbmcgYm90IGV4aXQ6JywgZXJyb3IpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUJvdFByb2Nlc3NFcnJvcih1c2VySWQ6IHN0cmluZywgZXJyb3I6IEVycm9yKSB7XG4gIHRyeSB7XG4gICAgYWN0aXZlQm90cy5kZWxldGUodXNlcklkKTtcbiAgICBcbiAgICBhd2FpdCBkYi51cGRhdGUoYm90SW5zdGFuY2VzKVxuICAgICAgLnNldCh7XG4gICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgc3RvcHBlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgfSlcbiAgICAgIC53aGVyZShlcShib3RJbnN0YW5jZXMudXNlcklkLCB1c2VySWQpKTtcbiAgICAgIFxuICAgIGNvbnNvbGUuZXJyb3IoYEJvdCBwcm9jZXNzIGVycm9yIGZvciB1c2VyICR7dXNlcklkfTpgLCBlcnJvcik7XG4gIH0gY2F0Y2ggKGRiRXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBoYW5kbGluZyBib3QgcHJvY2VzcyBlcnJvcjonLCBkYkVycm9yKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVCb3RIZWFydGJlYXQodXNlcklkOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBkYi51cGRhdGUoYm90SW5zdGFuY2VzKVxuICAgICAgLnNldCh7XG4gICAgICAgIGxhc3RIZWFydGJlYXQ6IG5ldyBEYXRlKCksXG4gICAgICB9KVxuICAgICAgLndoZXJlKGVxKGJvdEluc3RhbmNlcy51c2VySWQsIHVzZXJJZCkpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGJvdCBoZWFydGJlYXQ6JywgZXJyb3IpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHBhcnNlVHJhZGVPdXRwdXQob3V0cHV0OiBzdHJpbmcpOiBhbnkgfCBudWxsIHtcbiAgdHJ5IHtcbiAgICAvLyBQYXJzZSB0aGUgdHJhZGUgb3V0cHV0IGZyb20gdGhlIFB5dGhvbiBib3RcbiAgICAvLyBUaGlzIHdvdWxkIG5lZWQgdG8gbWF0Y2ggdGhlIG91dHB1dCBmb3JtYXQgZnJvbSB5b3VyIGJvdFxuICAgIGNvbnN0IHRyYWRlTWF0Y2ggPSBvdXRwdXQubWF0Y2goL1RSQURFX0NPTVBMRVRFRDogKC4rKS8pO1xuICAgIGlmICh0cmFkZU1hdGNoKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZSh0cmFkZU1hdGNoWzFdKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyB0cmFkZSBvdXRwdXQ6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNhdmVUcmFkZSh1c2VySWQ6IHN0cmluZywgdHJhZGVEYXRhOiBhbnkpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBkYi5pbnNlcnQodHJhZGVzKS52YWx1ZXMoe1xuICAgICAgdXNlcklkLFxuICAgICAgZXhjaGFuZ2VJZDogdHJhZGVEYXRhLmV4Y2hhbmdlLFxuICAgICAgdHJpYW5nbGVQYXRoOiB0cmFkZURhdGEudHJpYW5nbGVQYXRoLFxuICAgICAgaW5pdGlhbEFtb3VudDogdHJhZGVEYXRhLmluaXRpYWxBbW91bnQudG9TdHJpbmcoKSxcbiAgICAgIGZpbmFsQW1vdW50OiB0cmFkZURhdGEuZmluYWxBbW91bnQudG9TdHJpbmcoKSxcbiAgICAgIHByb2ZpdEFtb3VudDogdHJhZGVEYXRhLnByb2ZpdEFtb3VudC50b1N0cmluZygpLFxuICAgICAgcHJvZml0UGVyY2VudGFnZTogdHJhZGVEYXRhLnByb2ZpdFBlcmNlbnRhZ2UudG9TdHJpbmcoKSxcbiAgICAgIGZlZXM6IHRyYWRlRGF0YS5mZWVzLnRvU3RyaW5nKCksXG4gICAgICBzdGF0dXM6IHRyYWRlRGF0YS5zdGF0dXMsXG4gICAgICBleGVjdXRpb25UaW1lTXM6IHRyYWRlRGF0YS5leGVjdXRpb25UaW1lTXMsXG4gICAgICBlcnJvck1lc3NhZ2U6IHRyYWRlRGF0YS5lcnJvck1lc3NhZ2UsXG4gICAgICB0cmFkZURhdGE6IHRyYWRlRGF0YSxcbiAgICB9KTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhgU2F2ZWQgdHJhZGUgZm9yIHVzZXIgJHt1c2VySWR9OmAsIHRyYWRlRGF0YSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIHRyYWRlOicsIGVycm9yKTtcbiAgfVxufSJdLCJuYW1lcyI6WyJzcGF3biIsInBhdGgiLCJkYiIsImJvdEluc3RhbmNlcyIsInRyYWRlcyIsImVxIiwiYWN0aXZlQm90cyIsIk1hcCIsInN0YXJ0Qm90Rm9yVXNlciIsInVzZXJJZCIsImNyZWRlbnRpYWxzIiwic2V0dGluZ3MiLCJzdG9wQm90Rm9yVXNlciIsImVudiIsInByb2Nlc3MiLCJVU0VSX0lEIiwiQk9UX1NFVFRJTkdTIiwiSlNPTiIsInN0cmluZ2lmeSIsIkJPVF9DUkVERU5USUFMUyIsIk1JTl9QUk9GSVRfUEVSQ0VOVEFHRSIsIm1pblByb2ZpdFBlcmNlbnRhZ2UiLCJ0b1N0cmluZyIsIk1BWF9UUkFERV9BTU9VTlQiLCJtYXhUcmFkZUFtb3VudCIsIkFVVE9fVFJBRElOR19NT0RFIiwiYXV0b1RyYWRpbmdNb2RlIiwiU0VMRUNURURfRVhDSEFOR0VTIiwic2VsZWN0ZWRFeGNoYW5nZXMiLCJqb2luIiwiTk9ERV9FTlYiLCJmb3JFYWNoIiwiY3JlZCIsInByZWZpeCIsImV4Y2hhbmdlSWQiLCJ0b1VwcGVyQ2FzZSIsImFwaUtleSIsImFwaVNlY3JldCIsInBhc3NwaHJhc2UiLCJzYW5kYm94IiwiYm90UGF0aCIsImN3ZCIsImJvdFByb2Nlc3MiLCJzdGRpbyIsImJvdEluc3RhbmNlIiwiaWQiLCJEYXRlIiwibm93Iiwic3RhdHVzIiwic3RhcnRlZEF0Iiwic2V0Iiwic3Rkb3V0Iiwib24iLCJkYXRhIiwiY29uc29sZSIsImxvZyIsImhhbmRsZUJvdE91dHB1dCIsInN0ZGVyciIsImVycm9yIiwiaGFuZGxlQm90RXJyb3IiLCJjb2RlIiwiaGFuZGxlQm90RXhpdCIsImhhbmRsZUJvdFByb2Nlc3NFcnJvciIsInBpZCIsIkVycm9yIiwiZ2V0Iiwia2lsbCIsInNldFRpbWVvdXQiLCJraWxsZWQiLCJkZWxldGUiLCJnZXRCb3RTdGF0dXMiLCJnZXRBbGxBY3RpdmVCb3RzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwiZW1lcmdlbmN5U3RvcEFsbEJvdHMiLCJwcm9taXNlcyIsImtleXMiLCJtYXAiLCJjYXRjaCIsIlByb21pc2UiLCJhbGwiLCJvdXRwdXQiLCJpbmNsdWRlcyIsInRyYWRlRGF0YSIsInBhcnNlVHJhZGVPdXRwdXQiLCJzYXZlVHJhZGUiLCJ1cGRhdGVCb3RIZWFydGJlYXQiLCJ1cGRhdGUiLCJzdG9wcGVkQXQiLCJ3aGVyZSIsImRiRXJyb3IiLCJsYXN0SGVhcnRiZWF0IiwidHJhZGVNYXRjaCIsIm1hdGNoIiwicGFyc2UiLCJpbnNlcnQiLCJleGNoYW5nZSIsInRyaWFuZ2xlUGF0aCIsImluaXRpYWxBbW91bnQiLCJmaW5hbEFtb3VudCIsInByb2ZpdEFtb3VudCIsInByb2ZpdFBlcmNlbnRhZ2UiLCJmZWVzIiwiZXhlY3V0aW9uVGltZU1zIiwiZXJyb3JNZXNzYWdlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/bot-manager.ts\n");

/***/ }),

/***/ "(rsc)/./lib/config.ts":
/*!***********************!*\
  !*** ./lib/config.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FLAGS: () => (/* binding */ FLAGS),\n/* harmony export */   IS_DEV: () => (/* binding */ IS_DEV),\n/* harmony export */   IS_PROD: () => (/* binding */ IS_PROD),\n/* harmony export */   assertProdGuards: () => (/* binding */ assertProdGuards),\n/* harmony export */   devFlagEnabled: () => (/* binding */ devFlagEnabled)\n/* harmony export */ });\n/**\n * Centralized environment flags and production safeguards.\n * These flags enable development-only bypasses for admin and billing checks.\n * The guard ensures they cannot be enabled in production.\n */ const IS_PROD = \"development\" === 'production';\nconst IS_DEV = !IS_PROD;\nconst FLAGS = {\n    BILLING_DISABLED: process.env.BILLING_DISABLED === 'true',\n    GRANT_ADMIN_TO_ALL: process.env.GRANT_ADMIN_TO_ALL === 'true'\n};\n/**\n * Abort runtime when dangerous flags are enabled in production.\n * Should be invoked in critical paths that run server-side.\n */ function assertProdGuards() {\n    if (IS_PROD) {\n        if (FLAGS.BILLING_DISABLED) {\n            throw new Error('BILLING_DISABLED must not be true in production. Refusing to run.');\n        }\n        if (FLAGS.GRANT_ADMIN_TO_ALL) {\n            throw new Error('GRANT_ADMIN_TO_ALL must not be true in production. Refusing to run.');\n        }\n    }\n}\n/**\n * Helper to check if a dev-only flag is active (never true in production).\n */ function devFlagEnabled(flag) {\n    return IS_DEV && flag;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY29uZmlnLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7Ozs7Q0FJQyxHQUVNLE1BQU1BLFVBQVVDLGtCQUF5QixhQUFhO0FBQ3RELE1BQU1DLFNBQVMsQ0FBQ0YsUUFBUTtBQUV4QixNQUFNRyxRQUFRO0lBQ25CQyxrQkFBa0JILFFBQVFJLEdBQUcsQ0FBQ0QsZ0JBQWdCLEtBQUs7SUFDbkRFLG9CQUFvQkwsUUFBUUksR0FBRyxDQUFDQyxrQkFBa0IsS0FBSztBQUN6RCxFQUFFO0FBRUY7OztDQUdDLEdBQ00sU0FBU0M7SUFDZCxJQUFJUCxTQUFTO1FBQ1gsSUFBSUcsTUFBTUMsZ0JBQWdCLEVBQUU7WUFDMUIsTUFBTSxJQUFJSSxNQUFNO1FBQ2xCO1FBQ0EsSUFBSUwsTUFBTUcsa0JBQWtCLEVBQUU7WUFDNUIsTUFBTSxJQUFJRSxNQUFNO1FBQ2xCO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sU0FBU0MsZUFBZUMsSUFBYTtJQUMxQyxPQUFPUixVQUFVUTtBQUNuQiIsInNvdXJjZXMiOlsiQzpcXERlc2t0b3BcXGF1dG8tdHJhZGUuY29tXFxsaWJcXGNvbmZpZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENlbnRyYWxpemVkIGVudmlyb25tZW50IGZsYWdzIGFuZCBwcm9kdWN0aW9uIHNhZmVndWFyZHMuXG4gKiBUaGVzZSBmbGFncyBlbmFibGUgZGV2ZWxvcG1lbnQtb25seSBieXBhc3NlcyBmb3IgYWRtaW4gYW5kIGJpbGxpbmcgY2hlY2tzLlxuICogVGhlIGd1YXJkIGVuc3VyZXMgdGhleSBjYW5ub3QgYmUgZW5hYmxlZCBpbiBwcm9kdWN0aW9uLlxuICovXG5cbmV4cG9ydCBjb25zdCBJU19QUk9EID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJztcbmV4cG9ydCBjb25zdCBJU19ERVYgPSAhSVNfUFJPRDtcblxuZXhwb3J0IGNvbnN0IEZMQUdTID0ge1xuICBCSUxMSU5HX0RJU0FCTEVEOiBwcm9jZXNzLmVudi5CSUxMSU5HX0RJU0FCTEVEID09PSAndHJ1ZScsXG4gIEdSQU5UX0FETUlOX1RPX0FMTDogcHJvY2Vzcy5lbnYuR1JBTlRfQURNSU5fVE9fQUxMID09PSAndHJ1ZScsXG59O1xuXG4vKipcbiAqIEFib3J0IHJ1bnRpbWUgd2hlbiBkYW5nZXJvdXMgZmxhZ3MgYXJlIGVuYWJsZWQgaW4gcHJvZHVjdGlvbi5cbiAqIFNob3VsZCBiZSBpbnZva2VkIGluIGNyaXRpY2FsIHBhdGhzIHRoYXQgcnVuIHNlcnZlci1zaWRlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0UHJvZEd1YXJkcygpOiB2b2lkIHtcbiAgaWYgKElTX1BST0QpIHtcbiAgICBpZiAoRkxBR1MuQklMTElOR19ESVNBQkxFRCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdCSUxMSU5HX0RJU0FCTEVEIG11c3Qgbm90IGJlIHRydWUgaW4gcHJvZHVjdGlvbi4gUmVmdXNpbmcgdG8gcnVuLicpO1xuICAgIH1cbiAgICBpZiAoRkxBR1MuR1JBTlRfQURNSU5fVE9fQUxMKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dSQU5UX0FETUlOX1RPX0FMTCBtdXN0IG5vdCBiZSB0cnVlIGluIHByb2R1Y3Rpb24uIFJlZnVzaW5nIHRvIHJ1bi4nKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gY2hlY2sgaWYgYSBkZXYtb25seSBmbGFnIGlzIGFjdGl2ZSAobmV2ZXIgdHJ1ZSBpbiBwcm9kdWN0aW9uKS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldkZsYWdFbmFibGVkKGZsYWc6IGJvb2xlYW4pOiBib29sZWFuIHtcbiAgcmV0dXJuIElTX0RFViAmJiBmbGFnO1xufVxuIl0sIm5hbWVzIjpbIklTX1BST0QiLCJwcm9jZXNzIiwiSVNfREVWIiwiRkxBR1MiLCJCSUxMSU5HX0RJU0FCTEVEIiwiZW52IiwiR1JBTlRfQURNSU5fVE9fQUxMIiwiYXNzZXJ0UHJvZEd1YXJkcyIsIkVycm9yIiwiZGV2RmxhZ0VuYWJsZWQiLCJmbGFnIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/index.ts":
/*!*************************!*\
  !*** ./lib/db/index.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_neon_http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/neon-http */ \"(rsc)/./node_modules/drizzle-orm/neon-http/driver.js\");\n/* harmony import */ var _neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @neondatabase/serverless */ \"(rsc)/./node_modules/@neondatabase/serverless/index.mjs\");\n/* harmony import */ var _schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./schema */ \"(rsc)/./lib/db/schema.ts\");\n\n\n\nif (!process.env.DATABASE_URL) {\n    throw new Error('DATABASE_URL is not set');\n}\nconst sql = (0,_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neon)(process.env.DATABASE_URL);\nconst db = (0,drizzle_orm_neon_http__WEBPACK_IMPORTED_MODULE_2__.drizzle)(sql, {\n    schema: _schema__WEBPACK_IMPORTED_MODULE_1__\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFnRDtBQUNBO0FBQ2I7QUFFbkMsSUFBSSxDQUFDRyxRQUFRQyxHQUFHLENBQUNDLFlBQVksRUFBRTtJQUM3QixNQUFNLElBQUlDLE1BQU07QUFDbEI7QUFFQSxNQUFNQyxNQUFNTiw4REFBSUEsQ0FBQ0UsUUFBUUMsR0FBRyxDQUFDQyxZQUFZO0FBQ2xDLE1BQU1HLEtBQUtSLDhEQUFPQSxDQUFDTyxLQUFLO0lBQUVMLE1BQU1BLHNDQUFBQTtBQUFDLEdBQUciLCJzb3VyY2VzIjpbIkM6XFxEZXNrdG9wXFxhdXRvLXRyYWRlLmNvbVxcbGliXFxkYlxcaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZHJpenpsZSB9IGZyb20gJ2RyaXp6bGUtb3JtL25lb24taHR0cCc7XG5pbXBvcnQgeyBuZW9uIH0gZnJvbSAnQG5lb25kYXRhYmFzZS9zZXJ2ZXJsZXNzJztcbmltcG9ydCAqIGFzIHNjaGVtYSBmcm9tICcuL3NjaGVtYSc7XG5cbmlmICghcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKSB7XG4gIHRocm93IG5ldyBFcnJvcignREFUQUJBU0VfVVJMIGlzIG5vdCBzZXQnKTtcbn1cblxuY29uc3Qgc3FsID0gbmVvbihwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwpO1xuZXhwb3J0IGNvbnN0IGRiID0gZHJpenpsZShzcWwsIHsgc2NoZW1hIH0pOyJdLCJuYW1lcyI6WyJkcml6emxlIiwibmVvbiIsInNjaGVtYSIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJFcnJvciIsInNxbCIsImRiIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/index.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/schema.ts":
/*!**************************!*\
  !*** ./lib/db/schema.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   auditLogs: () => (/* binding */ auditLogs),\n/* harmony export */   botInstances: () => (/* binding */ botInstances),\n/* harmony export */   encryptionKeys: () => (/* binding */ encryptionKeys),\n/* harmony export */   exchangeCredentials: () => (/* binding */ exchangeCredentials),\n/* harmony export */   subscriptions: () => (/* binding */ subscriptions),\n/* harmony export */   trades: () => (/* binding */ trades),\n/* harmony export */   users: () => (/* binding */ users)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/table.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/text.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/boolean.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/timestamp.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/jsonb.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/numeric.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/integer.js\");\n/* harmony import */ var _paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @paralleldrive/cuid2 */ \"(rsc)/./node_modules/@paralleldrive/cuid2/index.js\");\n\n\nconst users = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('users', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('id').primaryKey(),\n    clerkId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('clerk_id').unique().notNull(),\n    email: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('email').notNull(),\n    firstName: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('first_name'),\n    lastName: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('last_name'),\n    imageUrl: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('image_url'),\n    isAdmin: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.boolean)('is_admin').default(false),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').defaultNow(),\n    updatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('updated_at').defaultNow()\n});\nconst subscriptions = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('subscriptions', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('id').primaryKey().$defaultFn(()=>(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('user_id').references(()=>users.id).notNull(),\n    lemonSqueezyId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('lemonsqueezy_id').unique().notNull(),\n    status: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('status').notNull(),\n    currentPeriodStart: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('current_period_start').notNull(),\n    currentPeriodEnd: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('current_period_end').notNull(),\n    cancelAtPeriodEnd: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.boolean)('cancel_at_period_end').default(false),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').defaultNow(),\n    updatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('updated_at').defaultNow()\n});\nconst exchangeCredentials = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('exchange_credentials', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('id').primaryKey().$defaultFn(()=>(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('user_id').references(()=>users.id).notNull(),\n    exchangeId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('exchange_id').notNull(),\n    apiKey: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('api_key').notNull(),\n    apiSecret: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('api_secret').notNull(),\n    passphrase: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('passphrase'),\n    sandbox: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.boolean)('sandbox').default(false),\n    isActive: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.boolean)('is_active').default(true),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').defaultNow(),\n    updatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('updated_at').defaultNow()\n});\nconst botInstances = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('bot_instances', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('id').primaryKey().$defaultFn(()=>(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('user_id').references(()=>users.id).notNull(),\n    status: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('status').notNull(),\n    settings: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.jsonb)('settings'),\n    startedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('started_at'),\n    stoppedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('stopped_at'),\n    lastHeartbeat: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('last_heartbeat'),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').defaultNow(),\n    updatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('updated_at').defaultNow()\n});\nconst trades = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('trades', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('id').primaryKey().$defaultFn(()=>(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('user_id').references(()=>users.id).notNull(),\n    botInstanceId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('bot_instance_id').references(()=>botInstances.id),\n    exchangeId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('exchange_id').notNull(),\n    trianglePath: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('triangle_path').notNull(),\n    initialAmount: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.decimal)('initial_amount', {\n        precision: 20,\n        scale: 8\n    }).notNull(),\n    finalAmount: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.decimal)('final_amount', {\n        precision: 20,\n        scale: 8\n    }).notNull(),\n    profitAmount: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.decimal)('profit_amount', {\n        precision: 20,\n        scale: 8\n    }).notNull(),\n    profitPercentage: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.decimal)('profit_percentage', {\n        precision: 10,\n        scale: 6\n    }).notNull(),\n    fees: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.decimal)('fees', {\n        precision: 20,\n        scale: 8\n    }).notNull(),\n    status: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('status').notNull(),\n    executionTimeMs: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.integer)('execution_time_ms'),\n    errorMessage: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('error_message'),\n    tradeData: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.jsonb)('trade_data'),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').defaultNow()\n});\nconst auditLogs = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('audit_logs', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('id').primaryKey().$defaultFn(()=>(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('user_id').references(()=>users.id),\n    action: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('action').notNull(),\n    resource: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('resource').notNull(),\n    resourceId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('resource_id'),\n    metadata: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.jsonb)('metadata'),\n    ipAddress: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('ip_address'),\n    userAgent: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('user_agent'),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').defaultNow()\n});\nconst encryptionKeys = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.pgTable)('encryption_keys', {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('id').primaryKey().$defaultFn(()=>(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()),\n    keyId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('key_id').unique().notNull(),\n    encryptedKey: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.text)('encrypted_key').notNull(),\n    isActive: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.boolean)('is_active').default(true),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('created_at').defaultNow(),\n    rotatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.timestamp)('rotated_at')\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNb0MsWUFBWXpELDREQUFPQSxDQUFDLGNBQWM7SUFDN0NTLElBQUlSLHlEQUFJQSxDQUFDLE1BQU1TLFVBQVUsR0FBR2MsVUFBVSxDQUFDLElBQU1qQiw4REFBUUE7SUFDckRrQixRQUFReEIseURBQUlBLENBQUMsV0FBV3lCLFVBQVUsQ0FBQyxJQUFNbEIsTUFBTUMsRUFBRTtJQUNqRGlELFFBQVF6RCx5REFBSUEsQ0FBQyxVQUFVWSxPQUFPO0lBQzlCOEMsVUFBVTFELHlEQUFJQSxDQUFDLFlBQVlZLE9BQU87SUFDbEMrQyxZQUFZM0QseURBQUlBLENBQUM7SUFDakI0RCxVQUFVeEQsMERBQUtBLENBQUM7SUFDaEJ5RCxXQUFXN0QseURBQUlBLENBQUM7SUFDaEI4RCxXQUFXOUQseURBQUlBLENBQUM7SUFDaEJtQixXQUFXbEIsOERBQVNBLENBQUMsY0FBY21CLFVBQVU7QUFDL0MsR0FBRztBQUVJLE1BQU0yQyxpQkFBaUJoRSw0REFBT0EsQ0FBQyxtQkFBbUI7SUFDdkRTLElBQUlSLHlEQUFJQSxDQUFDLE1BQU1TLFVBQVUsR0FBR2MsVUFBVSxDQUFDLElBQU1qQiw4REFBUUE7SUFDckQwRCxPQUFPaEUseURBQUlBLENBQUMsVUFBVVcsTUFBTSxHQUFHQyxPQUFPO0lBQ3RDcUQsY0FBY2pFLHlEQUFJQSxDQUFDLGlCQUFpQlksT0FBTztJQUMzQ3lCLFVBQVVuQyw0REFBT0EsQ0FBQyxhQUFhZ0IsT0FBTyxDQUFDO0lBQ3ZDQyxXQUFXbEIsOERBQVNBLENBQUMsY0FBY21CLFVBQVU7SUFDN0M4QyxXQUFXakUsOERBQVNBLENBQUM7QUFDdkIsR0FBRyIsInNvdXJjZXMiOlsiQzpcXERlc2t0b3BcXGF1dG8tdHJhZGUuY29tXFxsaWJcXGRiXFxzY2hlbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGdUYWJsZSwgdGV4dCwgdGltZXN0YW1wLCBib29sZWFuLCBpbnRlZ2VyLCBqc29uYiwgdXVpZCwgZGVjaW1hbCB9IGZyb20gJ2RyaXp6bGUtb3JtL3BnLWNvcmUnO1xuaW1wb3J0IHsgY3JlYXRlSWQgfSBmcm9tICdAcGFyYWxsZWxkcml2ZS9jdWlkMic7XG5cbmV4cG9ydCBjb25zdCB1c2VycyA9IHBnVGFibGUoJ3VzZXJzJywge1xuICBpZDogdGV4dCgnaWQnKS5wcmltYXJ5S2V5KCksXG4gIGNsZXJrSWQ6IHRleHQoJ2NsZXJrX2lkJykudW5pcXVlKCkubm90TnVsbCgpLFxuICBlbWFpbDogdGV4dCgnZW1haWwnKS5ub3ROdWxsKCksXG4gIGZpcnN0TmFtZTogdGV4dCgnZmlyc3RfbmFtZScpLFxuICBsYXN0TmFtZTogdGV4dCgnbGFzdF9uYW1lJyksXG4gIGltYWdlVXJsOiB0ZXh0KCdpbWFnZV91cmwnKSxcbiAgaXNBZG1pbjogYm9vbGVhbignaXNfYWRtaW4nKS5kZWZhdWx0KGZhbHNlKSxcbiAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoJ2NyZWF0ZWRfYXQnKS5kZWZhdWx0Tm93KCksXG4gIHVwZGF0ZWRBdDogdGltZXN0YW1wKCd1cGRhdGVkX2F0JykuZGVmYXVsdE5vdygpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBzdWJzY3JpcHRpb25zID0gcGdUYWJsZSgnc3Vic2NyaXB0aW9ucycsIHtcbiAgaWQ6IHRleHQoJ2lkJykucHJpbWFyeUtleSgpLiRkZWZhdWx0Rm4oKCkgPT4gY3JlYXRlSWQoKSksXG4gIHVzZXJJZDogdGV4dCgndXNlcl9pZCcpLnJlZmVyZW5jZXMoKCkgPT4gdXNlcnMuaWQpLm5vdE51bGwoKSxcbiAgbGVtb25TcXVlZXp5SWQ6IHRleHQoJ2xlbW9uc3F1ZWV6eV9pZCcpLnVuaXF1ZSgpLm5vdE51bGwoKSxcbiAgc3RhdHVzOiB0ZXh0KCdzdGF0dXMnKS5ub3ROdWxsKCksIC8vIGFjdGl2ZSwgY2FuY2VsbGVkLCBleHBpcmVkLCBwYXN0X2R1ZVxuICBjdXJyZW50UGVyaW9kU3RhcnQ6IHRpbWVzdGFtcCgnY3VycmVudF9wZXJpb2Rfc3RhcnQnKS5ub3ROdWxsKCksXG4gIGN1cnJlbnRQZXJpb2RFbmQ6IHRpbWVzdGFtcCgnY3VycmVudF9wZXJpb2RfZW5kJykubm90TnVsbCgpLFxuICBjYW5jZWxBdFBlcmlvZEVuZDogYm9vbGVhbignY2FuY2VsX2F0X3BlcmlvZF9lbmQnKS5kZWZhdWx0KGZhbHNlKSxcbiAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoJ2NyZWF0ZWRfYXQnKS5kZWZhdWx0Tm93KCksXG4gIHVwZGF0ZWRBdDogdGltZXN0YW1wKCd1cGRhdGVkX2F0JykuZGVmYXVsdE5vdygpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBleGNoYW5nZUNyZWRlbnRpYWxzID0gcGdUYWJsZSgnZXhjaGFuZ2VfY3JlZGVudGlhbHMnLCB7XG4gIGlkOiB0ZXh0KCdpZCcpLnByaW1hcnlLZXkoKS4kZGVmYXVsdEZuKCgpID0+IGNyZWF0ZUlkKCkpLFxuICB1c2VySWQ6IHRleHQoJ3VzZXJfaWQnKS5yZWZlcmVuY2VzKCgpID0+IHVzZXJzLmlkKS5ub3ROdWxsKCksXG4gIGV4Y2hhbmdlSWQ6IHRleHQoJ2V4Y2hhbmdlX2lkJykubm90TnVsbCgpLCAvLyBiaW5hbmNlLCBrdWNvaW4sIGV0Yy5cbiAgYXBpS2V5OiB0ZXh0KCdhcGlfa2V5Jykubm90TnVsbCgpLFxuICBhcGlTZWNyZXQ6IHRleHQoJ2FwaV9zZWNyZXQnKS5ub3ROdWxsKCksIC8vIGVuY3J5cHRlZFxuICBwYXNzcGhyYXNlOiB0ZXh0KCdwYXNzcGhyYXNlJyksIC8vIGVuY3J5cHRlZCwgZm9yIGV4Y2hhbmdlcyB0aGF0IG5lZWQgaXRcbiAgc2FuZGJveDogYm9vbGVhbignc2FuZGJveCcpLmRlZmF1bHQoZmFsc2UpLFxuICBpc0FjdGl2ZTogYm9vbGVhbignaXNfYWN0aXZlJykuZGVmYXVsdCh0cnVlKSxcbiAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoJ2NyZWF0ZWRfYXQnKS5kZWZhdWx0Tm93KCksXG4gIHVwZGF0ZWRBdDogdGltZXN0YW1wKCd1cGRhdGVkX2F0JykuZGVmYXVsdE5vdygpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBib3RJbnN0YW5jZXMgPSBwZ1RhYmxlKCdib3RfaW5zdGFuY2VzJywge1xuICBpZDogdGV4dCgnaWQnKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBjcmVhdGVJZCgpKSxcbiAgdXNlcklkOiB0ZXh0KCd1c2VyX2lkJykucmVmZXJlbmNlcygoKSA9PiB1c2Vycy5pZCkubm90TnVsbCgpLFxuICBzdGF0dXM6IHRleHQoJ3N0YXR1cycpLm5vdE51bGwoKSwgLy8gcnVubmluZywgc3RvcHBlZCwgZXJyb3JcbiAgc2V0dGluZ3M6IGpzb25iKCdzZXR0aW5ncycpLCAvLyBib3QgY29uZmlndXJhdGlvblxuICBzdGFydGVkQXQ6IHRpbWVzdGFtcCgnc3RhcnRlZF9hdCcpLFxuICBzdG9wcGVkQXQ6IHRpbWVzdGFtcCgnc3RvcHBlZF9hdCcpLFxuICBsYXN0SGVhcnRiZWF0OiB0aW1lc3RhbXAoJ2xhc3RfaGVhcnRiZWF0JyksXG4gIGNyZWF0ZWRBdDogdGltZXN0YW1wKCdjcmVhdGVkX2F0JykuZGVmYXVsdE5vdygpLFxuICB1cGRhdGVkQXQ6IHRpbWVzdGFtcCgndXBkYXRlZF9hdCcpLmRlZmF1bHROb3coKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdHJhZGVzID0gcGdUYWJsZSgndHJhZGVzJywge1xuICBpZDogdGV4dCgnaWQnKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBjcmVhdGVJZCgpKSxcbiAgdXNlcklkOiB0ZXh0KCd1c2VyX2lkJykucmVmZXJlbmNlcygoKSA9PiB1c2Vycy5pZCkubm90TnVsbCgpLFxuICBib3RJbnN0YW5jZUlkOiB0ZXh0KCdib3RfaW5zdGFuY2VfaWQnKS5yZWZlcmVuY2VzKCgpID0+IGJvdEluc3RhbmNlcy5pZCksXG4gIGV4Y2hhbmdlSWQ6IHRleHQoJ2V4Y2hhbmdlX2lkJykubm90TnVsbCgpLFxuICB0cmlhbmdsZVBhdGg6IHRleHQoJ3RyaWFuZ2xlX3BhdGgnKS5ub3ROdWxsKCksXG4gIGluaXRpYWxBbW91bnQ6IGRlY2ltYWwoJ2luaXRpYWxfYW1vdW50JywgeyBwcmVjaXNpb246IDIwLCBzY2FsZTogOCB9KS5ub3ROdWxsKCksXG4gIGZpbmFsQW1vdW50OiBkZWNpbWFsKCdmaW5hbF9hbW91bnQnLCB7IHByZWNpc2lvbjogMjAsIHNjYWxlOiA4IH0pLm5vdE51bGwoKSxcbiAgcHJvZml0QW1vdW50OiBkZWNpbWFsKCdwcm9maXRfYW1vdW50JywgeyBwcmVjaXNpb246IDIwLCBzY2FsZTogOCB9KS5ub3ROdWxsKCksXG4gIHByb2ZpdFBlcmNlbnRhZ2U6IGRlY2ltYWwoJ3Byb2ZpdF9wZXJjZW50YWdlJywgeyBwcmVjaXNpb246IDEwLCBzY2FsZTogNiB9KS5ub3ROdWxsKCksXG4gIGZlZXM6IGRlY2ltYWwoJ2ZlZXMnLCB7IHByZWNpc2lvbjogMjAsIHNjYWxlOiA4IH0pLm5vdE51bGwoKSxcbiAgc3RhdHVzOiB0ZXh0KCdzdGF0dXMnKS5ub3ROdWxsKCksIC8vIHN1Y2Nlc3MsIGZhaWxlZCwgcGFydGlhbFxuICBleGVjdXRpb25UaW1lTXM6IGludGVnZXIoJ2V4ZWN1dGlvbl90aW1lX21zJyksXG4gIGVycm9yTWVzc2FnZTogdGV4dCgnZXJyb3JfbWVzc2FnZScpLFxuICB0cmFkZURhdGE6IGpzb25iKCd0cmFkZV9kYXRhJyksIC8vIGRldGFpbGVkIHRyYWRlIGluZm9ybWF0aW9uXG4gIGNyZWF0ZWRBdDogdGltZXN0YW1wKCdjcmVhdGVkX2F0JykuZGVmYXVsdE5vdygpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBhdWRpdExvZ3MgPSBwZ1RhYmxlKCdhdWRpdF9sb2dzJywge1xuICBpZDogdGV4dCgnaWQnKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBjcmVhdGVJZCgpKSxcbiAgdXNlcklkOiB0ZXh0KCd1c2VyX2lkJykucmVmZXJlbmNlcygoKSA9PiB1c2Vycy5pZCksXG4gIGFjdGlvbjogdGV4dCgnYWN0aW9uJykubm90TnVsbCgpLFxuICByZXNvdXJjZTogdGV4dCgncmVzb3VyY2UnKS5ub3ROdWxsKCksXG4gIHJlc291cmNlSWQ6IHRleHQoJ3Jlc291cmNlX2lkJyksXG4gIG1ldGFkYXRhOiBqc29uYignbWV0YWRhdGEnKSxcbiAgaXBBZGRyZXNzOiB0ZXh0KCdpcF9hZGRyZXNzJyksXG4gIHVzZXJBZ2VudDogdGV4dCgndXNlcl9hZ2VudCcpLFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcCgnY3JlYXRlZF9hdCcpLmRlZmF1bHROb3coKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgZW5jcnlwdGlvbktleXMgPSBwZ1RhYmxlKCdlbmNyeXB0aW9uX2tleXMnLCB7XG4gIGlkOiB0ZXh0KCdpZCcpLnByaW1hcnlLZXkoKS4kZGVmYXVsdEZuKCgpID0+IGNyZWF0ZUlkKCkpLFxuICBrZXlJZDogdGV4dCgna2V5X2lkJykudW5pcXVlKCkubm90TnVsbCgpLFxuICBlbmNyeXB0ZWRLZXk6IHRleHQoJ2VuY3J5cHRlZF9rZXknKS5ub3ROdWxsKCksXG4gIGlzQWN0aXZlOiBib29sZWFuKCdpc19hY3RpdmUnKS5kZWZhdWx0KHRydWUpLFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcCgnY3JlYXRlZF9hdCcpLmRlZmF1bHROb3coKSxcbiAgcm90YXRlZEF0OiB0aW1lc3RhbXAoJ3JvdGF0ZWRfYXQnKSxcbn0pO1xuXG4vLyBUeXBlc1xuZXhwb3J0IHR5cGUgVXNlciA9IHR5cGVvZiB1c2Vycy4kaW5mZXJTZWxlY3Q7XG5leHBvcnQgdHlwZSBOZXdVc2VyID0gdHlwZW9mIHVzZXJzLiRpbmZlckluc2VydDtcbmV4cG9ydCB0eXBlIFN1YnNjcmlwdGlvbiA9IHR5cGVvZiBzdWJzY3JpcHRpb25zLiRpbmZlclNlbGVjdDtcbmV4cG9ydCB0eXBlIEV4Y2hhbmdlQ3JlZGVudGlhbCA9IHR5cGVvZiBleGNoYW5nZUNyZWRlbnRpYWxzLiRpbmZlclNlbGVjdDtcbmV4cG9ydCB0eXBlIEJvdEluc3RhbmNlID0gdHlwZW9mIGJvdEluc3RhbmNlcy4kaW5mZXJTZWxlY3Q7XG5leHBvcnQgdHlwZSBUcmFkZSA9IHR5cGVvZiB0cmFkZXMuJGluZmVyU2VsZWN0O1xuZXhwb3J0IHR5cGUgQXVkaXRMb2cgPSB0eXBlb2YgYXVkaXRMb2dzLiRpbmZlclNlbGVjdDsiXSwibmFtZXMiOlsicGdUYWJsZSIsInRleHQiLCJ0aW1lc3RhbXAiLCJib29sZWFuIiwiaW50ZWdlciIsImpzb25iIiwiZGVjaW1hbCIsImNyZWF0ZUlkIiwidXNlcnMiLCJpZCIsInByaW1hcnlLZXkiLCJjbGVya0lkIiwidW5pcXVlIiwibm90TnVsbCIsImVtYWlsIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJpbWFnZVVybCIsImlzQWRtaW4iLCJkZWZhdWx0IiwiY3JlYXRlZEF0IiwiZGVmYXVsdE5vdyIsInVwZGF0ZWRBdCIsInN1YnNjcmlwdGlvbnMiLCIkZGVmYXVsdEZuIiwidXNlcklkIiwicmVmZXJlbmNlcyIsImxlbW9uU3F1ZWV6eUlkIiwic3RhdHVzIiwiY3VycmVudFBlcmlvZFN0YXJ0IiwiY3VycmVudFBlcmlvZEVuZCIsImNhbmNlbEF0UGVyaW9kRW5kIiwiZXhjaGFuZ2VDcmVkZW50aWFscyIsImV4Y2hhbmdlSWQiLCJhcGlLZXkiLCJhcGlTZWNyZXQiLCJwYXNzcGhyYXNlIiwic2FuZGJveCIsImlzQWN0aXZlIiwiYm90SW5zdGFuY2VzIiwic2V0dGluZ3MiLCJzdGFydGVkQXQiLCJzdG9wcGVkQXQiLCJsYXN0SGVhcnRiZWF0IiwidHJhZGVzIiwiYm90SW5zdGFuY2VJZCIsInRyaWFuZ2xlUGF0aCIsImluaXRpYWxBbW91bnQiLCJwcmVjaXNpb24iLCJzY2FsZSIsImZpbmFsQW1vdW50IiwicHJvZml0QW1vdW50IiwicHJvZml0UGVyY2VudGFnZSIsImZlZXMiLCJleGVjdXRpb25UaW1lTXMiLCJlcnJvck1lc3NhZ2UiLCJ0cmFkZURhdGEiLCJhdWRpdExvZ3MiLCJhY3Rpb24iLCJyZXNvdXJjZSIsInJlc291cmNlSWQiLCJtZXRhZGF0YSIsImlwQWRkcmVzcyIsInVzZXJBZ2VudCIsImVuY3J5cHRpb25LZXlzIiwia2V5SWQiLCJlbmNyeXB0ZWRLZXkiLCJyb3RhdGVkQXQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/schema.ts\n");

/***/ }),

/***/ "(rsc)/./lib/encryption.ts":
/*!***************************!*\
  !*** ./lib/encryption.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decryptCredentials: () => (/* binding */ decryptCredentials),\n/* harmony export */   encryptCredentials: () => (/* binding */ encryptCredentials),\n/* harmony export */   rotateEncryptionKey: () => (/* binding */ rotateEncryptionKey)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db/index.ts\");\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db/schema */ \"(rsc)/./lib/db/schema.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n\n\n\n\nconst ALGORITHM = 'aes-256-gcm';\nconst IV_LENGTH = 16;\nconst TAG_LENGTH = 16;\nconst SALT_LENGTH = 32;\n// Get or create master encryption key\nasync function getMasterKey() {\n    const masterKeyEnv = process.env.MASTER_ENCRYPTION_KEY;\n    if (!masterKeyEnv) {\n        throw new Error('MASTER_ENCRYPTION_KEY environment variable is required');\n    }\n    return Buffer.from(masterKeyEnv, 'hex');\n}\n// Get active encryption key from database\nasync function getActiveEncryptionKey() {\n    const activeKey = await _db__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_db_schema__WEBPACK_IMPORTED_MODULE_2__.encryptionKeys).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_3__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.encryptionKeys.isActive, true)).limit(1);\n    if (activeKey.length === 0) {\n        // Create new encryption key\n        const keyId = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomUUID();\n        const dataKey = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(32);\n        const masterKey = await getMasterKey();\n        // Encrypt the data key with master key (modern method)\n        const iv = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(IV_LENGTH);\n        const derivedKey = crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash('sha256').update(masterKey).digest(); // 32-byte key\n        const cipher = crypto__WEBPACK_IMPORTED_MODULE_0___default().createCipheriv('aes-256-cbc', derivedKey, iv);\n        let encryptedKey = cipher.update(dataKey);\n        encryptedKey = Buffer.concat([\n            encryptedKey,\n            cipher.final()\n        ]);\n        await _db__WEBPACK_IMPORTED_MODULE_1__.db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_2__.encryptionKeys).values({\n            keyId,\n            encryptedKey: `${iv.toString('hex')}:${encryptedKey.toString('hex')}`,\n            isActive: true\n        });\n        return dataKey.toString('hex');\n    }\n    // Decrypt existing key\n    const masterKey = await getMasterKey();\n    const [ivHex, encryptedKeyHex] = activeKey[0].encryptedKey.split(':');\n    const iv = Buffer.from(ivHex, 'hex');\n    const encryptedKey = Buffer.from(encryptedKeyHex, 'hex');\n    const derivedKey = crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash('sha256').update(masterKey).digest();\n    const decipher = crypto__WEBPACK_IMPORTED_MODULE_0___default().createDecipheriv('aes-256-cbc', derivedKey, iv);\n    let decryptedKey = decipher.update(encryptedKey);\n    decryptedKey = Buffer.concat([\n        decryptedKey,\n        decipher.final()\n    ]);\n    return decryptedKey.toString('hex');\n}\nasync function encryptCredentials(plaintext) {\n    try {\n        const dataKey = Buffer.from(await getActiveEncryptionKey(), 'hex');\n        const iv = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(IV_LENGTH);\n        const salt = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(SALT_LENGTH);\n        // Derive key using PBKDF2\n        const key = crypto__WEBPACK_IMPORTED_MODULE_0___default().pbkdf2Sync(dataKey, salt, 100000, 32, 'sha256');\n        const cipher = crypto__WEBPACK_IMPORTED_MODULE_0___default().createCipheriv(ALGORITHM, key, iv);\n        let encrypted = cipher.update(plaintext, 'utf8', 'hex');\n        encrypted += cipher.final('hex');\n        const tag = cipher.getAuthTag();\n        // Format: salt:iv:tag:encrypted\n        return `${salt.toString('hex')}:${iv.toString('hex')}:${tag.toString('hex')}:${encrypted}`;\n    } catch (error) {\n        console.error('Encryption error:', error);\n        throw new Error('Failed to encrypt credentials');\n    }\n}\nasync function decryptCredentials(encryptedData) {\n    try {\n        const dataKey = Buffer.from(await getActiveEncryptionKey(), 'hex');\n        const [saltHex, ivHex, tagHex, encrypted] = encryptedData.split(':');\n        const salt = Buffer.from(saltHex, 'hex');\n        const iv = Buffer.from(ivHex, 'hex');\n        const tag = Buffer.from(tagHex, 'hex');\n        // Derive key using PBKDF2\n        const key = crypto__WEBPACK_IMPORTED_MODULE_0___default().pbkdf2Sync(dataKey, salt, 100000, 32, 'sha256');\n        const decipher = crypto__WEBPACK_IMPORTED_MODULE_0___default().createDecipheriv(ALGORITHM, key, iv);\n        decipher.setAuthTag(tag);\n        let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n        decrypted += decipher.final('utf8');\n        return decrypted;\n    } catch (error) {\n        console.error('Decryption error:', error);\n        throw new Error('Failed to decrypt credentials');\n    }\n}\n// Rotate encryption keys (for security)\nasync function rotateEncryptionKey() {\n    try {\n        // Mark current key as inactive\n        await _db__WEBPACK_IMPORTED_MODULE_1__.db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.encryptionKeys).set({\n            isActive: false,\n            rotatedAt: new Date()\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_3__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.encryptionKeys.isActive, true));\n        console.log('Encryption key rotation completed');\n    } catch (error) {\n        console.error('Key rotation error:', error);\n        throw new Error('Failed to rotate encryption key');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cEIsSUFBSTtRQUNGLCtCQUErQjtRQUMvQixNQUFNOUQsbUNBQUVBLENBQ0w4QixNQUFNLENBQUM3QixzREFBY0EsRUFDckI4RCxHQUFHLENBQUM7WUFDSDVDLFVBQVU7WUFDVjZDLFdBQVcsSUFBSUM7UUFDakIsR0FDQy9DLEtBQUssQ0FBQ2hCLCtDQUFFQSxDQUFDRCxzREFBY0EsQ0FBQ2tCLFFBQVEsRUFBRTtRQUVyQ29DLFFBQVFXLEdBQUcsQ0FBQztJQUNkLEVBQUUsT0FBT1osT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsdUJBQXVCQTtRQUNyQyxNQUFNLElBQUkxQyxNQUFNO0lBQ2xCO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxEZXNrdG9wXFxhdXRvLXRyYWRlLmNvbVxcbGliXFxlbmNyeXB0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi9kYic7XG5pbXBvcnQgeyBlbmNyeXB0aW9uS2V5cyB9IGZyb20gJy4vZGIvc2NoZW1hJztcbmltcG9ydCB7IGVxIH0gZnJvbSAnZHJpenpsZS1vcm0nO1xuXG5jb25zdCBBTEdPUklUSE0gPSAnYWVzLTI1Ni1nY20nO1xuY29uc3QgSVZfTEVOR1RIID0gMTY7XG5jb25zdCBUQUdfTEVOR1RIID0gMTY7XG5jb25zdCBTQUxUX0xFTkdUSCA9IDMyO1xuXG4vLyBHZXQgb3IgY3JlYXRlIG1hc3RlciBlbmNyeXB0aW9uIGtleVxuYXN5bmMgZnVuY3Rpb24gZ2V0TWFzdGVyS2V5KCk6IFByb21pc2U8QnVmZmVyPiB7XG4gIGNvbnN0IG1hc3RlcktleUVudiA9IHByb2Nlc3MuZW52Lk1BU1RFUl9FTkNSWVBUSU9OX0tFWTtcbiAgaWYgKCFtYXN0ZXJLZXlFbnYpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01BU1RFUl9FTkNSWVBUSU9OX0tFWSBlbnZpcm9ubWVudCB2YXJpYWJsZSBpcyByZXF1aXJlZCcpO1xuICB9XG5cbiAgcmV0dXJuIEJ1ZmZlci5mcm9tKG1hc3RlcktleUVudiwgJ2hleCcpO1xufVxuXG4vLyBHZXQgYWN0aXZlIGVuY3J5cHRpb24ga2V5IGZyb20gZGF0YWJhc2VcbmFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2ZUVuY3J5cHRpb25LZXkoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgYWN0aXZlS2V5ID0gYXdhaXQgZGJcbiAgICAuc2VsZWN0KClcbiAgICAuZnJvbShlbmNyeXB0aW9uS2V5cylcbiAgICAud2hlcmUoZXEoZW5jcnlwdGlvbktleXMuaXNBY3RpdmUsIHRydWUpKVxuICAgIC5saW1pdCgxKTtcblxuICBpZiAoYWN0aXZlS2V5Lmxlbmd0aCA9PT0gMCkge1xuICAgIC8vIENyZWF0ZSBuZXcgZW5jcnlwdGlvbiBrZXlcbiAgICBjb25zdCBrZXlJZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgY29uc3QgZGF0YUtleSA9IGNyeXB0by5yYW5kb21CeXRlcygzMik7XG4gICAgY29uc3QgbWFzdGVyS2V5ID0gYXdhaXQgZ2V0TWFzdGVyS2V5KCk7XG5cbiAgICAvLyBFbmNyeXB0IHRoZSBkYXRhIGtleSB3aXRoIG1hc3RlciBrZXkgKG1vZGVybiBtZXRob2QpXG4gICAgY29uc3QgaXYgPSBjcnlwdG8ucmFuZG9tQnl0ZXMoSVZfTEVOR1RIKTtcbiAgICBjb25zdCBkZXJpdmVkS2V5ID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShtYXN0ZXJLZXkpLmRpZ2VzdCgpOyAvLyAzMi1ieXRlIGtleVxuICAgIGNvbnN0IGNpcGhlciA9IGNyeXB0by5jcmVhdGVDaXBoZXJpdignYWVzLTI1Ni1jYmMnLCBkZXJpdmVkS2V5LCBpdik7XG5cbiAgICBsZXQgZW5jcnlwdGVkS2V5ID0gY2lwaGVyLnVwZGF0ZShkYXRhS2V5KTtcbiAgICBlbmNyeXB0ZWRLZXkgPSBCdWZmZXIuY29uY2F0KFtlbmNyeXB0ZWRLZXksIGNpcGhlci5maW5hbCgpXSk7XG5cbiAgICBhd2FpdCBkYi5pbnNlcnQoZW5jcnlwdGlvbktleXMpLnZhbHVlcyh7XG4gICAgICBrZXlJZCxcbiAgICAgIGVuY3J5cHRlZEtleTogYCR7aXYudG9TdHJpbmcoJ2hleCcpfToke2VuY3J5cHRlZEtleS50b1N0cmluZygnaGV4Jyl9YCxcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGRhdGFLZXkudG9TdHJpbmcoJ2hleCcpO1xuICB9XG5cbiAgLy8gRGVjcnlwdCBleGlzdGluZyBrZXlcbiAgY29uc3QgbWFzdGVyS2V5ID0gYXdhaXQgZ2V0TWFzdGVyS2V5KCk7XG4gIGNvbnN0IFtpdkhleCwgZW5jcnlwdGVkS2V5SGV4XSA9IGFjdGl2ZUtleVswXS5lbmNyeXB0ZWRLZXkuc3BsaXQoJzonKTtcbiAgY29uc3QgaXYgPSBCdWZmZXIuZnJvbShpdkhleCwgJ2hleCcpO1xuICBjb25zdCBlbmNyeXB0ZWRLZXkgPSBCdWZmZXIuZnJvbShlbmNyeXB0ZWRLZXlIZXgsICdoZXgnKTtcbiAgY29uc3QgZGVyaXZlZEtleSA9IGNyeXB0by5jcmVhdGVIYXNoKCdzaGEyNTYnKS51cGRhdGUobWFzdGVyS2V5KS5kaWdlc3QoKTtcbiAgY29uc3QgZGVjaXBoZXIgPSBjcnlwdG8uY3JlYXRlRGVjaXBoZXJpdignYWVzLTI1Ni1jYmMnLCBkZXJpdmVkS2V5LCBpdik7XG5cbiAgbGV0IGRlY3J5cHRlZEtleSA9IGRlY2lwaGVyLnVwZGF0ZShlbmNyeXB0ZWRLZXkpO1xuICBkZWNyeXB0ZWRLZXkgPSBCdWZmZXIuY29uY2F0KFtkZWNyeXB0ZWRLZXksIGRlY2lwaGVyLmZpbmFsKCldKTtcblxuICByZXR1cm4gZGVjcnlwdGVkS2V5LnRvU3RyaW5nKCdoZXgnKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuY3J5cHRDcmVkZW50aWFscyhwbGFpbnRleHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZGF0YUtleSA9IEJ1ZmZlci5mcm9tKGF3YWl0IGdldEFjdGl2ZUVuY3J5cHRpb25LZXkoKSwgJ2hleCcpO1xuICAgIGNvbnN0IGl2ID0gY3J5cHRvLnJhbmRvbUJ5dGVzKElWX0xFTkdUSCk7XG4gICAgY29uc3Qgc2FsdCA9IGNyeXB0by5yYW5kb21CeXRlcyhTQUxUX0xFTkdUSCk7XG5cbiAgICAvLyBEZXJpdmUga2V5IHVzaW5nIFBCS0RGMlxuICAgIGNvbnN0IGtleSA9IGNyeXB0by5wYmtkZjJTeW5jKGRhdGFLZXksIHNhbHQsIDEwMDAwMCwgMzIsICdzaGEyNTYnKTtcblxuICAgIGNvbnN0IGNpcGhlciA9IGNyeXB0by5jcmVhdGVDaXBoZXJpdihBTEdPUklUSE0sIGtleSwgaXYpO1xuICAgIGxldCBlbmNyeXB0ZWQgPSBjaXBoZXIudXBkYXRlKHBsYWludGV4dCwgJ3V0ZjgnLCAnaGV4Jyk7XG4gICAgZW5jcnlwdGVkICs9IGNpcGhlci5maW5hbCgnaGV4Jyk7XG5cbiAgICBjb25zdCB0YWcgPSBjaXBoZXIuZ2V0QXV0aFRhZygpO1xuXG4gICAgLy8gRm9ybWF0OiBzYWx0Oml2OnRhZzplbmNyeXB0ZWRcbiAgICByZXR1cm4gYCR7c2FsdC50b1N0cmluZygnaGV4Jyl9OiR7aXYudG9TdHJpbmcoJ2hleCcpfToke3RhZy50b1N0cmluZygnaGV4Jyl9OiR7ZW5jcnlwdGVkfWA7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRW5jcnlwdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZW5jcnlwdCBjcmVkZW50aWFscycpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWNyeXB0Q3JlZGVudGlhbHMoZW5jcnlwdGVkRGF0YTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkYXRhS2V5ID0gQnVmZmVyLmZyb20oYXdhaXQgZ2V0QWN0aXZlRW5jcnlwdGlvbktleSgpLCAnaGV4Jyk7XG4gICAgY29uc3QgW3NhbHRIZXgsIGl2SGV4LCB0YWdIZXgsIGVuY3J5cHRlZF0gPSBlbmNyeXB0ZWREYXRhLnNwbGl0KCc6Jyk7XG5cbiAgICBjb25zdCBzYWx0ID0gQnVmZmVyLmZyb20oc2FsdEhleCwgJ2hleCcpO1xuICAgIGNvbnN0IGl2ID0gQnVmZmVyLmZyb20oaXZIZXgsICdoZXgnKTtcbiAgICBjb25zdCB0YWcgPSBCdWZmZXIuZnJvbSh0YWdIZXgsICdoZXgnKTtcblxuICAgIC8vIERlcml2ZSBrZXkgdXNpbmcgUEJLREYyXG4gICAgY29uc3Qga2V5ID0gY3J5cHRvLnBia2RmMlN5bmMoZGF0YUtleSwgc2FsdCwgMTAwMDAwLCAzMiwgJ3NoYTI1NicpO1xuXG4gICAgY29uc3QgZGVjaXBoZXIgPSBjcnlwdG8uY3JlYXRlRGVjaXBoZXJpdihBTEdPUklUSE0sIGtleSwgaXYpO1xuICAgIGRlY2lwaGVyLnNldEF1dGhUYWcodGFnKTtcblxuICAgIGxldCBkZWNyeXB0ZWQgPSBkZWNpcGhlci51cGRhdGUoZW5jcnlwdGVkLCAnaGV4JywgJ3V0ZjgnKTtcbiAgICBkZWNyeXB0ZWQgKz0gZGVjaXBoZXIuZmluYWwoJ3V0ZjgnKTtcblxuICAgIHJldHVybiBkZWNyeXB0ZWQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRGVjcnlwdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZGVjcnlwdCBjcmVkZW50aWFscycpO1xuICB9XG59XG5cbi8vIFJvdGF0ZSBlbmNyeXB0aW9uIGtleXMgKGZvciBzZWN1cml0eSlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByb3RhdGVFbmNyeXB0aW9uS2V5KCk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIC8vIE1hcmsgY3VycmVudCBrZXkgYXMgaW5hY3RpdmVcbiAgICBhd2FpdCBkYlxuICAgICAgLnVwZGF0ZShlbmNyeXB0aW9uS2V5cylcbiAgICAgIC5zZXQoe1xuICAgICAgICBpc0FjdGl2ZTogZmFsc2UsXG4gICAgICAgIHJvdGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIH0pXG4gICAgICAud2hlcmUoZXEoZW5jcnlwdGlvbktleXMuaXNBY3RpdmUsIHRydWUpKTtcblxuICAgIGNvbnNvbGUubG9nKCdFbmNyeXB0aW9uIGtleSByb3RhdGlvbiBjb21wbGV0ZWQnKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdLZXkgcm90YXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHJvdGF0ZSBlbmNyeXB0aW9uIGtleScpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiZGIiLCJlbmNyeXB0aW9uS2V5cyIsImVxIiwiQUxHT1JJVEhNIiwiSVZfTEVOR1RIIiwiVEFHX0xFTkdUSCIsIlNBTFRfTEVOR1RIIiwiZ2V0TWFzdGVyS2V5IiwibWFzdGVyS2V5RW52IiwicHJvY2VzcyIsImVudiIsIk1BU1RFUl9FTkNSWVBUSU9OX0tFWSIsIkVycm9yIiwiQnVmZmVyIiwiZnJvbSIsImdldEFjdGl2ZUVuY3J5cHRpb25LZXkiLCJhY3RpdmVLZXkiLCJzZWxlY3QiLCJ3aGVyZSIsImlzQWN0aXZlIiwibGltaXQiLCJsZW5ndGgiLCJrZXlJZCIsInJhbmRvbVVVSUQiLCJkYXRhS2V5IiwicmFuZG9tQnl0ZXMiLCJtYXN0ZXJLZXkiLCJpdiIsImRlcml2ZWRLZXkiLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0IiwiY2lwaGVyIiwiY3JlYXRlQ2lwaGVyaXYiLCJlbmNyeXB0ZWRLZXkiLCJjb25jYXQiLCJmaW5hbCIsImluc2VydCIsInZhbHVlcyIsInRvU3RyaW5nIiwiaXZIZXgiLCJlbmNyeXB0ZWRLZXlIZXgiLCJzcGxpdCIsImRlY2lwaGVyIiwiY3JlYXRlRGVjaXBoZXJpdiIsImRlY3J5cHRlZEtleSIsImVuY3J5cHRDcmVkZW50aWFscyIsInBsYWludGV4dCIsInNhbHQiLCJrZXkiLCJwYmtkZjJTeW5jIiwiZW5jcnlwdGVkIiwidGFnIiwiZ2V0QXV0aFRhZyIsImVycm9yIiwiY29uc29sZSIsImRlY3J5cHRDcmVkZW50aWFscyIsImVuY3J5cHRlZERhdGEiLCJzYWx0SGV4IiwidGFnSGV4Iiwic2V0QXV0aFRhZyIsImRlY3J5cHRlZCIsInJvdGF0ZUVuY3J5cHRpb25LZXkiLCJzZXQiLCJyb3RhdGVkQXQiLCJEYXRlIiwibG9nIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/encryption.ts\n");

/***/ }),

/***/ "(rsc)/./lib/subscription.ts":
/*!*****************************!*\
  !*** ./lib/subscription.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkSubscription: () => (/* binding */ checkSubscription),\n/* harmony export */   getUserSubscription: () => (/* binding */ getUserSubscription)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db/index.ts\");\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db/schema */ \"(rsc)/./lib/db/schema.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var _admin__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./admin */ \"(rsc)/./lib/admin.ts\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./config */ \"(rsc)/./lib/config.ts\");\n\n\n\n\n\nasync function checkSubscription(userId) {\n    try {\n        (0,_config__WEBPACK_IMPORTED_MODULE_3__.assertProdGuards)();\n        // Dev-only global billing bypass\n        if ((0,_config__WEBPACK_IMPORTED_MODULE_3__.devFlagEnabled)(_config__WEBPACK_IMPORTED_MODULE_3__.FLAGS.BILLING_DISABLED)) {\n            return {\n                isActive: true,\n                status: 'dev-bypass',\n                currentPeriodEnd: null,\n                cancelAtPeriodEnd: false\n            };\n        }\n        // Admins bypass subscription checks\n        const isAdmin = await (0,_admin__WEBPACK_IMPORTED_MODULE_2__.checkAdminAccess)(userId);\n        if (isAdmin) {\n            return {\n                isActive: true,\n                status: 'admin',\n                currentPeriodEnd: null,\n                cancelAtPeriodEnd: false\n            };\n        }\n        const subscription = await _db__WEBPACK_IMPORTED_MODULE_0__.db.select().from(_db_schema__WEBPACK_IMPORTED_MODULE_1__.subscriptions).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_4__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.subscriptions.userId, userId)).limit(1);\n        if (subscription.length === 0) {\n            return {\n                isActive: false,\n                status: 'none',\n                currentPeriodEnd: null,\n                cancelAtPeriodEnd: false\n            };\n        }\n        const sub = subscription[0];\n        const now = new Date();\n        const isActive = sub.status === 'active' && sub.currentPeriodEnd > now;\n        return {\n            isActive,\n            status: sub.status,\n            currentPeriodEnd: sub.currentPeriodEnd,\n            cancelAtPeriodEnd: sub.cancelAtPeriodEnd ?? false\n        };\n    } catch (error) {\n        console.error('Error checking subscription:', error);\n        return {\n            isActive: false,\n            status: 'error',\n            currentPeriodEnd: null,\n            cancelAtPeriodEnd: false\n        };\n    }\n}\nasync function getUserSubscription(userId) {\n    try {\n        const subscription = await _db__WEBPACK_IMPORTED_MODULE_0__.db.select().from(_db_schema__WEBPACK_IMPORTED_MODULE_1__.subscriptions).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_4__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.subscriptions.userId, userId)).limit(1);\n        return subscription[0] || null;\n    } catch (error) {\n        console.error('Error fetching user subscription:', error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3Vic2NyaXB0aW9uLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBMEI7QUFDa0I7QUFDWDtBQUNVO0FBQ3dCO0FBUzVELGVBQWVPLGtCQUFrQkMsTUFBYztJQUNwRCxJQUFJO1FBQ0ZGLHlEQUFnQkE7UUFDaEIsaUNBQWlDO1FBQ2pDLElBQUlELHVEQUFjQSxDQUFDRCwwQ0FBS0EsQ0FBQ0ssZ0JBQWdCLEdBQUc7WUFDMUMsT0FBTztnQkFDTEMsVUFBVTtnQkFDVkMsUUFBUTtnQkFDUkMsa0JBQWtCO2dCQUNsQkMsbUJBQW1CO1lBQ3JCO1FBQ0Y7UUFDQSxvQ0FBb0M7UUFDcEMsTUFBTUMsVUFBVSxNQUFNWCx3REFBZ0JBLENBQUNLO1FBQ3ZDLElBQUlNLFNBQVM7WUFDWCxPQUFPO2dCQUNMSixVQUFVO2dCQUNWQyxRQUFRO2dCQUNSQyxrQkFBa0I7Z0JBQ2xCQyxtQkFBbUI7WUFDckI7UUFDRjtRQUNBLE1BQU1FLGVBQWUsTUFBTWYsbUNBQUVBLENBQUNnQixNQUFNLEdBQ2pDQyxJQUFJLENBQUNoQixxREFBYUEsRUFDbEJpQixLQUFLLENBQUNoQiwrQ0FBRUEsQ0FBQ0QscURBQWFBLENBQUNPLE1BQU0sRUFBRUEsU0FDL0JXLEtBQUssQ0FBQztRQUVULElBQUlKLGFBQWFLLE1BQU0sS0FBSyxHQUFHO1lBQzdCLE9BQU87Z0JBQ0xWLFVBQVU7Z0JBQ1ZDLFFBQVE7Z0JBQ1JDLGtCQUFrQjtnQkFDbEJDLG1CQUFtQjtZQUNyQjtRQUNGO1FBRUEsTUFBTVEsTUFBTU4sWUFBWSxDQUFDLEVBQUU7UUFDM0IsTUFBTU8sTUFBTSxJQUFJQztRQUNoQixNQUFNYixXQUFXVyxJQUFJVixNQUFNLEtBQUssWUFBWVUsSUFBSVQsZ0JBQWdCLEdBQUdVO1FBRW5FLE9BQU87WUFDTFo7WUFDQUMsUUFBUVUsSUFBSVYsTUFBTTtZQUNsQkMsa0JBQWtCUyxJQUFJVCxnQkFBZ0I7WUFDdENDLG1CQUFtQlEsSUFBSVIsaUJBQWlCLElBQUk7UUFDOUM7SUFDRixFQUFFLE9BQU9XLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGdDQUFnQ0E7UUFDOUMsT0FBTztZQUNMZCxVQUFVO1lBQ1ZDLFFBQVE7WUFDUkMsa0JBQWtCO1lBQ2xCQyxtQkFBbUI7UUFDckI7SUFDRjtBQUNGO0FBRU8sZUFBZWEsb0JBQW9CbEIsTUFBYztJQUN0RCxJQUFJO1FBQ0YsTUFBTU8sZUFBZSxNQUFNZixtQ0FBRUEsQ0FBQ2dCLE1BQU0sR0FDakNDLElBQUksQ0FBQ2hCLHFEQUFhQSxFQUNsQmlCLEtBQUssQ0FBQ2hCLCtDQUFFQSxDQUFDRCxxREFBYUEsQ0FBQ08sTUFBTSxFQUFFQSxTQUMvQlcsS0FBSyxDQUFDO1FBRVQsT0FBT0osWUFBWSxDQUFDLEVBQUUsSUFBSTtJQUM1QixFQUFFLE9BQU9TLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHFDQUFxQ0E7UUFDbkQsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxEZXNrdG9wXFxhdXRvLXRyYWRlLmNvbVxcbGliXFxzdWJzY3JpcHRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGIgfSBmcm9tICcuL2RiJztcbmltcG9ydCB7IHN1YnNjcmlwdGlvbnMgfSBmcm9tICcuL2RiL3NjaGVtYSc7XG5pbXBvcnQgeyBlcSB9IGZyb20gJ2RyaXp6bGUtb3JtJztcbmltcG9ydCB7IGNoZWNrQWRtaW5BY2Nlc3MgfSBmcm9tICcuL2FkbWluJztcbmltcG9ydCB7IEZMQUdTLCBkZXZGbGFnRW5hYmxlZCwgYXNzZXJ0UHJvZEd1YXJkcyB9IGZyb20gJy4vY29uZmlnJztcblxuZXhwb3J0IGludGVyZmFjZSBTdWJzY3JpcHRpb25TdGF0dXMge1xuICBpc0FjdGl2ZTogYm9vbGVhbjtcbiAgc3RhdHVzOiBzdHJpbmc7XG4gIGN1cnJlbnRQZXJpb2RFbmQ6IERhdGUgfCBudWxsO1xuICBjYW5jZWxBdFBlcmlvZEVuZDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrU3Vic2NyaXB0aW9uKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxTdWJzY3JpcHRpb25TdGF0dXM+IHtcbiAgdHJ5IHtcbiAgICBhc3NlcnRQcm9kR3VhcmRzKCk7XG4gICAgLy8gRGV2LW9ubHkgZ2xvYmFsIGJpbGxpbmcgYnlwYXNzXG4gICAgaWYgKGRldkZsYWdFbmFibGVkKEZMQUdTLkJJTExJTkdfRElTQUJMRUQpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgc3RhdHVzOiAnZGV2LWJ5cGFzcycsXG4gICAgICAgIGN1cnJlbnRQZXJpb2RFbmQ6IG51bGwsXG4gICAgICAgIGNhbmNlbEF0UGVyaW9kRW5kOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuICAgIC8vIEFkbWlucyBieXBhc3Mgc3Vic2NyaXB0aW9uIGNoZWNrc1xuICAgIGNvbnN0IGlzQWRtaW4gPSBhd2FpdCBjaGVja0FkbWluQWNjZXNzKHVzZXJJZCk7XG4gICAgaWYgKGlzQWRtaW4pIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICBzdGF0dXM6ICdhZG1pbicsXG4gICAgICAgIGN1cnJlbnRQZXJpb2RFbmQ6IG51bGwsXG4gICAgICAgIGNhbmNlbEF0UGVyaW9kRW5kOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IGRiLnNlbGVjdCgpXG4gICAgICAuZnJvbShzdWJzY3JpcHRpb25zKVxuICAgICAgLndoZXJlKGVxKHN1YnNjcmlwdGlvbnMudXNlcklkLCB1c2VySWQpKVxuICAgICAgLmxpbWl0KDEpO1xuXG4gICAgaWYgKHN1YnNjcmlwdGlvbi5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgICAgc3RhdHVzOiAnbm9uZScsXG4gICAgICAgIGN1cnJlbnRQZXJpb2RFbmQ6IG51bGwsXG4gICAgICAgIGNhbmNlbEF0UGVyaW9kRW5kOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3Qgc3ViID0gc3Vic2NyaXB0aW9uWzBdO1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgaXNBY3RpdmUgPSBzdWIuc3RhdHVzID09PSAnYWN0aXZlJyAmJiBzdWIuY3VycmVudFBlcmlvZEVuZCA+IG5vdztcblxuICAgIHJldHVybiB7XG4gICAgICBpc0FjdGl2ZSxcbiAgICAgIHN0YXR1czogc3ViLnN0YXR1cyxcbiAgICAgIGN1cnJlbnRQZXJpb2RFbmQ6IHN1Yi5jdXJyZW50UGVyaW9kRW5kLFxuICAgICAgY2FuY2VsQXRQZXJpb2RFbmQ6IHN1Yi5jYW5jZWxBdFBlcmlvZEVuZCA/PyBmYWxzZSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIHN1YnNjcmlwdGlvbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzQWN0aXZlOiBmYWxzZSxcbiAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgIGN1cnJlbnRQZXJpb2RFbmQ6IG51bGwsXG4gICAgICBjYW5jZWxBdFBlcmlvZEVuZDogZmFsc2UsXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclN1YnNjcmlwdGlvbih1c2VySWQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IGRiLnNlbGVjdCgpXG4gICAgICAuZnJvbShzdWJzY3JpcHRpb25zKVxuICAgICAgLndoZXJlKGVxKHN1YnNjcmlwdGlvbnMudXNlcklkLCB1c2VySWQpKVxuICAgICAgLmxpbWl0KDEpO1xuXG4gICAgcmV0dXJuIHN1YnNjcmlwdGlvblswXSB8fCBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHVzZXIgc3Vic2NyaXB0aW9uOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufSJdLCJuYW1lcyI6WyJkYiIsInN1YnNjcmlwdGlvbnMiLCJlcSIsImNoZWNrQWRtaW5BY2Nlc3MiLCJGTEFHUyIsImRldkZsYWdFbmFibGVkIiwiYXNzZXJ0UHJvZEd1YXJkcyIsImNoZWNrU3Vic2NyaXB0aW9uIiwidXNlcklkIiwiQklMTElOR19ESVNBQkxFRCIsImlzQWN0aXZlIiwic3RhdHVzIiwiY3VycmVudFBlcmlvZEVuZCIsImNhbmNlbEF0UGVyaW9kRW5kIiwiaXNBZG1pbiIsInN1YnNjcmlwdGlvbiIsInNlbGVjdCIsImZyb20iLCJ3aGVyZSIsImxpbWl0IiwibGVuZ3RoIiwic3ViIiwibm93IiwiRGF0ZSIsImVycm9yIiwiY29uc29sZSIsImdldFVzZXJTdWJzY3JpcHRpb24iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/subscription.ts\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fbot%2Fstart%2Froute&page=%2Fapi%2Fbot%2Fstart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbot%2Fstart%2Froute.ts&appDir=C%3A%5CDesktop%5Cauto-trade.com%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CDesktop%5Cauto-trade.com&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fbot%2Fstart%2Froute&page=%2Fapi%2Fbot%2Fstart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbot%2Fstart%2Froute.ts&appDir=C%3A%5CDesktop%5Cauto-trade.com%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CDesktop%5Cauto-trade.com&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var C_Desktop_auto_trade_com_app_api_bot_start_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./app/api/bot/start/route.ts */ \"(rsc)/./app/api/bot/start/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/bot/start/route\",\n        pathname: \"/api/bot/start\",\n        filename: \"route\",\n        bundlePath: \"app/api/bot/start/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"C:\\\\Desktop\\\\auto-trade.com\\\\app\\\\api\\\\bot\\\\start\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Desktop_auto_trade_com_app_api_bot_start_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/bot/start/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZib3QlMkZzdGFydCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYm90JTJGc3RhcnQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZib3QlMkZzdGFydCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDRGVza3RvcCU1Q2F1dG8tdHJhZGUuY29tJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDRGVza3RvcCU1Q2F1dG8tdHJhZGUuY29tJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQ3NCO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztBQUMvRDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdB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Q0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOLDZCQUE2Qiw2RkFBZTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNkVBQVk7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0IHsgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBub3JtYWxpemVBcHBQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9hcHAtcGF0aHNcIjtcbmltcG9ydCB7IE5vZGVOZXh0UmVxdWVzdCwgTm9kZU5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Jhc2UtaHR0cC9ub2RlXCI7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycywgdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IENhY2hlZFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcRGVza3RvcFxcXFxhdXRvLXRyYWRlLmNvbVxcXFxhcHBcXFxcYXBpXFxcXGJvdFxcXFxzdGFydFxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYm90L3N0YXJ0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYm90L3N0YXJ0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9ib3Qvc3RhcnQvcm91dGVcIlxuICAgIH0sXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHJlbGF0aXZlUHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnLFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcRGVza3RvcFxcXFxhdXRvLXRyYWRlLmNvbVxcXFxhcHBcXFxcYXBpXFxcXGJvdFxcXFxzdGFydFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICB2YXIgX25leHRDb25maWdfZXhwZXJpbWVudGFsO1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL2JvdC9zdGFydC9yb3V0ZVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNSZXZhbGlkYXRlID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICBwYXJhbXMsXG4gICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbXBvbmVudHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuY2FjaGVDb21wb25lbnRzKSxcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWwuY2FjaGVMaWZlLFxuICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgb25DbG9zZTogKGNiKT0+e1xuICAgICAgICAgICAgICAgIHJlcy5vbignY2xvc2UnLCBjYik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BZnRlclRhc2tFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb25JbnN0cnVtZW50YXRpb25SZXF1ZXN0RXJyb3I6IChlcnJvciwgX3JlcXVlc3QsIGVycm9yQ29udGV4dCk9PnJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyb3IsIGVycm9yQ29udGV4dCwgcm91dGVyU2VydmVyQ29udGV4dClcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkQ29udGV4dDoge1xuICAgICAgICAgICAgYnVpbGRJZFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBub2RlTmV4dFJlcSA9IG5ldyBOb2RlTmV4dFJlcXVlc3QocmVxKTtcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XG4gICAgY29uc3QgbmV4dFJlcSA9IE5leHRSZXF1ZXN0QWRhcHRlci5mcm9tTm9kZU5leHRSZXF1ZXN0KG5vZGVOZXh0UmVxLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlKHJlcykpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICByZXR1cm4gcm91dGVNb2R1bGUuaGFuZGxlKG5leHRSZXEsIGNvbnRleHQpLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHdlIGRvbid0IGNyZWF0ZSBhIGNhY2hlRW50cnkgZm9yIElTUlxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWUxO1xuICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFyaWFudDogYXBwLXJvdXRlIHJlY2VpdmVkIGludmFsaWQgY2FjaGUgZW50cnkgJHtjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUxID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlMS5raW5kfWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XG4gICAgICAgICAgICBpZiAoIShnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzSXNyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuZGVsZXRlKE5FWFRfQ0FDSEVfVEFHU19IRUFERVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgY2FjaGUgY29udHJvbCBpcyBhbHJlYWR5IHNldCBvbiB0aGUgcmVzcG9uc2Ugd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIGl0IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZSBpdCB2aWEgbmV4dC5jb25maWdcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCBnZXRDYWNoZUNvbnRyb2xIZWFkZXIoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fbot%2Fstart%2Froute&page=%2Fapi%2Fbot%2Fstart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbot%2Fstart%2Froute.ts&appDir=C%3A%5CDesktop%5Cauto-trade.com%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CDesktop%5Cauto-trade.com&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

"use strict";
module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:path");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@clerk","vendor-chunks/next","vendor-chunks/cookie","vendor-chunks/drizzle-orm","vendor-chunks/@neondatabase","vendor-chunks/@noble","vendor-chunks/@paralleldrive"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fbot%2Fstart%2Froute&page=%2Fapi%2Fbot%2Fstart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbot%2Fstart%2Froute.ts&appDir=C%3A%5CDesktop%5Cauto-trade.com%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CDesktop%5Cauto-trade.com&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();